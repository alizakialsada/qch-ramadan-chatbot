<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QCH â€“ Smart Ramadan Medication Assistant (v8 full)</title>
  <meta name="description" content="Qatif Central Hospital â€“ Ramadan Medication Assistant (Arabic/English)." />
  <style>
    :root{
      --bg:#0b1f26; --text:#eaf6fb; --muted:#b7d2dd;
      --accent:#35d0c7; --accent2:#2aa6ff;
      --danger:#ff4d4f; --warn:#f5a524; --ok:#22c55e;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Arial,sans-serif;
    }
    body{margin:0;background:radial-gradient(1200px 700px at 20% 10%, #15404d 0%, var(--bg) 55%);color:var(--text);}
    .wrap{max-width:1220px;margin:24px auto;padding:16px}
    .top{background:linear-gradient(135deg,#123747,#0d2a34);border:1px solid rgba(255,255,255,.08);border-radius:18px;box-shadow:var(--shadow);
      padding:18px;display:flex;gap:16px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .brand{display:flex;gap:14px;align-items:center}
    .logo{width:54px;height:54px;border-radius:16px;background:linear-gradient(135deg,var(--accent2),var(--accent));
      display:grid;place-items:center;font-weight:900;box-shadow:0 10px 20px rgba(0,0,0,.25)}
    .title h1{margin:0;font-size:18px}
    .title p{margin:4px 0 0;color:var(--muted);font-size:13px}
    .controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    select, button, input{
      background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:var(--text);
      padding:10px 12px;border-radius:14px;outline:none;font-size:13px
    }
    button{cursor:pointer;background:rgba(53,208,199,.14);border-color:rgba(53,208,199,.35)}
    .grid{margin-top:16px;display:grid;grid-template-columns:1.45fr .75fr;gap:16px}
    @media (max-width: 980px){.grid{grid-template-columns:1fr}}
    .card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.10);border-radius:18px;box-shadow:var(--shadow);overflow:hidden;min-height:560px}
    .card header{padding:14px 16px;background:rgba(0,0,0,.15);border-bottom:1px solid rgba(255,255,255,.08);
      display:flex;align-items:center;justify-content:space-between;gap:10px}
    .badge{font-size:12px;color:var(--muted);padding:6px 10px;border:1px solid rgba(255,255,255,.12);border-radius:999px}
    .pillrow{display:flex;flex-wrap:wrap;gap:8px;padding:14px 16px 10px}
    .pill{font-size:12px;color:var(--text);padding:8px 10px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.10);
      border-radius:999px;cursor:pointer;user-select:none}
    .pill:hover{border-color:rgba(53,208,199,.45)}
    /* IMPORTANT FIX: composer is fixed so it is ALWAYS clickable */
    .chatWrap{display:flex;flex-direction:column;height:560px}
    .chatlog{flex:1;padding:16px;overflow:auto;-webkit-overflow-scrolling:touch}
    .composer{
      display:flex;gap:10px;padding:12px;margin:12px;
      background:rgba(8,18,22,.78);
      border:1px solid rgba(255,255,255,.10);border-radius:16px;backdrop-filter: blur(10px)
    }
    .composer input{flex:1;font-size:14px}
    .msg{display:flex;margin:10px 0}
    .msg .bubble{max-width:88%;padding:12px;border-radius:16px;line-height:1.35;font-size:14px;border:1px solid rgba(255,255,255,.10);white-space:pre-wrap}
    .me{justify-content:flex-end}
    .me .bubble{background:rgba(53,208,199,.16);border-color:rgba(53,208,199,.35)}
    .bot .bubble{background:rgba(255,255,255,.06)}
    .chips{margin-top:8px;display:flex;gap:8px;flex-wrap:wrap}
    .chip{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(0,0,0,.12)}
    .chip.ok{border-color:rgba(34,197,94,.45)}
    .chip.warn{border-color:rgba(245,165,36,.45)}
    .chip.danger{border-color:rgba(255,77,79,.45)}
    .side .content{padding:16px;color:var(--muted);font-size:13px;line-height:1.5}
    .alert{margin-top:10px;padding:10px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05)}
    .alert.warn{border-color:rgba(245,165,36,.45)}
    .alert.ok{border-color:rgba(34,197,94,.45)}
    .foot{margin-top:14px;font-size:12px;color:rgba(234,246,251,.75)}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;}

    /* RTL support when Arabic selected */
    body.rtl { direction: rtl; }
    body.rtl .brand { flex-direction: row-reverse; }
    body.rtl .controls { flex-direction: row-reverse; }
    body.rtl .card header { flex-direction: row-reverse; }
    body.rtl .pillrow { justify-content: flex-start; }
    body.rtl .msg.bot { justify-content: flex-start; }
    body.rtl .msg.me { justify-content: flex-end; }
    body.rtl .bubble { text-align: right; }

  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo">QCH</div>
        <div class="title">
          <h1 id="uiTitle">Ù…Ø³Ø§Ø¹Ø¯ Ø£Ø¯ÙˆÙŠØ© Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ø°ÙƒÙŠ â€“ Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù‚Ø·ÙŠÙ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</h1>
          <p id="uiSubtitle">Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø·Ø¨ÙŠØ©: Ø§Ù„Ø¯ÙˆØ§Ø¡ + Ø§Ù„ÙØ¦Ø© + Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª</p>
        </div>
      </div>
      <div class="controls">
        <select id="mode">
          <option value="patient" selected id="optPatient">Ù…Ø±ÙŠØ¶</option>
          <option value="hcp" id="optHcp">ÙƒÙˆØ§Ø¯Ø± ØµØ­ÙŠØ©</option>
        </select>
        <button id="reset" type="button">Reset</button>
      </div>
    </div>

    <div class="grid">
      <section class="card">
        <header>
          <div style="font-weight:800" id="uiChatTitle">Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</div>
          <div class="badge">Ramadan â€¢ Arabic Only (RTL) â€“ Typing Fix v2</div>
        </header>

        <div class="pillrow" id="quick"></div>

        <div class="chatWrap">
          <div class="chatlog" id="chat"></div>
          <div class="composer">
            <input id="input" type="text" dir="rtl" inputmode="text" autocapitalize="off" autocorrect="off"
                   placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡â€¦" autocomplete="off" />
            <button id="send" type="button">Send</button>
          </div>
        </div>
      </section>

      <aside class="card side">
        <header>
          <div style="font-weight:800" id="uiSafetyTitle">Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</div>
          <div class="badge">No PHI stored</div>
        </header>
        <div class="content">
          <div class="alert warn">
            <b id="uiImportantLabel">Important:</b> <span id="uiImportantText">General guidance only. For insulin, warfarin, pregnancy, CKD/CLD, transplant, chemotherapy, seizure meds, or complex regimens â†’ consult your clinician/pharmacist.</span>
          </div>
          <div class="alert ok" id="welcomeBox"></div>

          <div class="alert">
            <b id="uiPerfectLabel">Perfect Ramadan method:</b><br/>
            <span id="uiPerfectText">1) Type the medication name. If not found â†’ type a class (e.g., antibiotic, PPI, blood pressure).<br/>
            2) If still unknown, the assistant will ask: How many times per day? (OD/BID/TID/QID).<br/>
            3) Follow the timing and the warning labels (â›”/âš ï¸/âœ…).</span>
          </div>

          
          <div class="alert">
            <b>QR / Share:</b><br/>
            Put your GitHub Pages link here, then click copy.<br/>
            <input id="shareLink" type="text" placeholder="https://YOUR-USERNAME.github.io/YOUR-REPO/" style="width:100%;margin-top:8px" />
            <div style="display:flex;gap:10px;margin-top:8px;flex-wrap:wrap">
              <button id="copyLink" type="button">Copy link</button>
              <button id="setLink" type="button">Use current page</button>
            </div>
            <div id="copyStatus" style="margin-top:8px;color:rgba(234,246,251,.75)"></div>
          </div>

          <div class="foot">
            <span id="uiCreatedBy">Created by</span> <b>Ali Alsada</b><br/>
            <span id="uiPharmDept">Pharmacy Department â€¢ Qatif Central Hospital</span>
          </div>
        </div>
      </aside>
    </div>
  </div>

<script>
(() => {
  const ui = {
    lang: { value: 'ar', addEventListener: ()=>{} },
    mode: document.getElementById('mode'),
    reset: document.getElementById('reset'),
    chat: document.getElementById('chat'),
    input: document.getElementById('input'),
    send: document.getElementById('send'),
    quick: document.getElementById('quick'),
    welcomeBox: document.getElementById('welcomeBox'),
    shareLink: document.getElementById('shareLink'),
    copyLink: document.getElementById('copyLink'),
    setLink: document.getElementById('setLink'),
    copyStatus: document.getElementById('copyStatus'),
  };

  function t(ar,en){ return ar; }

  function applyDir(){
    document.body.classList.add("rtl");
    document.documentElement.setAttribute("lang","ar");
  }

  function translateUI(){
    // Top area
    const title = document.getElementById("uiTitle");
    if(title) title.textContent = "Ù…Ø³Ø§Ø¹Ø¯ Ø£Ø¯ÙˆÙŠØ© Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ø°ÙƒÙŠ â€“ Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù‚Ø·ÙŠÙ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ";

    const subtitle = document.getElementById("uiSubtitle");
    if(subtitle) subtitle.textContent = "Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø·Ø¨ÙŠØ©: Ø§Ù„Ø¯ÙˆØ§Ø¡ + Ø§Ù„ÙØ¦Ø© + Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª";

    // Section headers
    const chatT = document.getElementById("uiChatTitle");
    if(chatT) chatT.textContent = "Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©";

    const safetyT = document.getElementById("uiSafetyTitle");
    if(safetyT) safetyT.textContent = "Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…";

    // Controls
    ui.reset.textContent = "Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·";
    ui.send.textContent = "Ø¥Ø±Ø³Ø§Ù„";
    ui.input.placeholder = "Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡â€¦ / Ø£Ùˆ Ø§ÙƒØªØ¨ Ø§Ù„ÙØ¦Ø©â€¦";

    const imp = document.getElementById("uiImportantLabel");
    if(imp) imp.textContent = "Ù…Ù‡Ù…:";

    const impText = document.getElementById("uiImportantText");
    if(impText) impText.textContent = "Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© ÙÙ‚Ø·. ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ù†Ø³ÙˆÙ„ÙŠÙ†ØŒ Ø§Ù„ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ†ØŒ Ø§Ù„Ø­Ù…Ù„ØŒ Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„ÙƒÙ„Ù‰/Ø§Ù„ÙƒØ¨Ø¯ØŒ Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ØŒ Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„ÙƒÙŠÙ…Ø§ÙˆÙŠØŒ Ø£Ø¯ÙˆÙŠØ© Ø§Ù„ØµØ±Ø¹ØŒ Ø£Ùˆ Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø© â†’ Ø§Ø³ØªØ´Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨/Ø§Ù„ØµÙŠØ¯Ù„ÙŠ.";

    const perfect = document.getElementById("uiPerfectLabel");
    if(perfect) perfect.textContent = "Ø£ÙØ¶Ù„ Ø·Ø±ÙŠÙ‚Ø© ÙÙŠ Ø±Ù…Ø¶Ø§Ù†:";

    const perfectText = document.getElementById("uiPerfectText");
    if(perfectText) perfectText.innerHTML = "1) Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡. Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¸Ù‡Ø± â†’ Ø§ÙƒØªØ¨ Ø§Ù„ÙØ¦Ø© (Ù…Ø«Ù„: Ù…Ø¶Ø§Ø¯ Ø­ÙŠÙˆÙŠØŒ PPIØŒ Ø¶ØºØ·).<br/>2) Ø¥Ø°Ø§ Ù…Ø§Ø²Ø§Ù„ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØŒ Ø³ÙŠØ³Ø£Ù„Ùƒ: ÙƒÙ… Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ØŸ (OD/BID/TID/QID).<br/>3) Ø§ØªØ¨Ø¹ Ø§Ù„ØªÙˆÙ‚ÙŠØª ÙˆØ¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ­Ø°ÙŠØ± (â›”/âš ï¸/âœ…).";

    const createdBy = document.getElementById("uiCreatedBy");
    if(createdBy) createdBy.textContent = "Ø¥Ø¹Ø¯Ø§Ø¯";

    const dept = document.getElementById("uiPharmDept");
    if(dept) dept.textContent = "Ù‚Ø³Ù… Ø§Ù„ØµÙŠØ¯Ù„ÙŠØ© â€¢ Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù‚Ø·ÙŠÙ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ";

    // Share box (Arabic)
    const shareTitle = document.querySelector('.alert b');
    // keep as-is if not found; share block already bilingual/English in HTML, we won't over-edit here
  }


  function pushMsg(text, who="bot", chips=[]){
    const row = document.createElement("div");
    row.className = "msg " + (who==="me" ? "me":"bot");
    const bubble = document.createElement("div");
    bubble.className = "bubble";
    bubble.textContent = text;
    if(chips && chips.length){
      const c = document.createElement("div");
      c.className = "chips";
      chips.forEach(ch=>{
        const s = document.createElement("span");
        s.className = "chip " + (ch.level||"");
        s.textContent = t(ch.ar, ch.en);
        c.appendChild(s);
      });
      bubble.appendChild(c);
    }
    row.appendChild(bubble);
    ui.chat.appendChild(row);
    ui.chat.scrollTop = ui.chat.scrollHeight;
  }
  function normalize(s){
    return (s||"").toLowerCase().replace(/\s+/g," ").trim();
  }
  function chips(list){ return (list||[]).map(x=>({level:x.l, ar:x.ar, en:x.en})); }

  function freqGuidance(freq){
    if(freq==="od"){
      return {
        en: "âœ… Once daily (OD): take after Iftar.\nâ€¢ If empty-stomach medicine: take 30â€“60 min before Suhoor (water only).\nâ€¢ Keep the same time every day.",
        ar: "âœ… Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ (OD): Ø®Ø°Ù‡Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±.\nâ€¢ Ø¥Ø°Ø§ Ø¯ÙˆØ§Ø¡ Ø¹Ù„Ù‰ Ù…Ø¹Ø¯Ø© ÙØ§Ø±ØºØ©: Ø®Ø°Ù‡ Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø­ÙˆØ± 30â€“60 Ø¯Ù‚ÙŠÙ‚Ø© (Ù…Ø§Ø¡ ÙÙ‚Ø·).\nâ€¢ Ø«Ø¨Ù‘Øª Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§.",
        chips: chips([{l:"ok",ar:"Ø«Ø¨Ù‘Øª Ø§Ù„ÙˆÙ‚Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§",en:"Keep timing consistent"}])
      };
    }
    if(freq==="bid"){
      return {
        en: "âœ… Twice daily (BID): 1st dose after Iftar + 2nd dose after Suhoor (as close to 12 hours apart as possible).",
        ar: "âœ… Ù…Ø±ØªÙŠÙ† ÙŠÙˆÙ…ÙŠÙ‹Ø§ (BID): Ø§Ù„Ø¬Ø±Ø¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ± (Ù‚Ø±ÙŠØ¨ Ù…Ù† 12 Ø³Ø§Ø¹Ø© Ù‚Ø¯Ø± Ø§Ù„Ø¥Ù…ÙƒØ§Ù†).",
        chips: chips([{l:"ok",ar:"Ø¥ÙØ·Ø§Ø± + Ø³Ø­ÙˆØ±",en:"Iftar + Suhoor"}])
      };
    }
    if(freq==="tid"){
      return {
        en: "âš  Three times daily (TID): usually not ideal in Ramadan.\nâœ… Ask clinician to switch to BID or XR.\nâ›” Do NOT self-adjust.",
        ar: "âš  Ø«Ù„Ø§Ø« Ù…Ø±Ø§Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§ (TID): ØºØ§Ù„Ø¨Ù‹Ø§ ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨ ÙÙŠ Ø±Ù…Ø¶Ø§Ù†.\nâœ… Ø§Ø³ØªØ´Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨ Ù„ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Ù…Ø±ØªÙŠÙ† Ø£Ùˆ XR.\nâ›” Ù„Ø§ ØªØ¹Ø¯Ù‘Ù„ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ø¨Ù†ÙØ³Ùƒ.",
        chips: chips([{l:"warn",ar:"ÙŠÙØ¶Ù„ ØªØ­ÙˆÙŠÙ„Ù‡",en:"Prefer switch to BID/XR"},{l:"danger",ar:"Ù„Ø§ ØªØ¹Ø¯Ù„ Ø¨Ù†ÙØ³Ùƒ",en:"Do not self-adjust"}])
      };
    }
    return {
      en: "â›” Four times daily (QID): not compatible with fasting safely for most meds. Consult your clinician.",
      ar: "â›” Ø£Ø±Ø¨Ø¹ Ù…Ø±Ø§Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§ (QID): ØºØ§Ù„Ø¨Ù‹Ø§ ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„ØµÙŠØ§Ù… Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†. Ø§Ø³ØªØ´Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨.",
      chips: chips([{l:"danger",ar:"Ø§Ø³ØªØ´Ø§Ø±Ø© Ø¶Ø±ÙˆØ±ÙŠØ©",en:"Consultation required"}])
    };
  }

  function entry(keys, catEn, catAr, patEn, patAr, ch=[], hcpObj=null){
    return {keys: keys.map(normalize), cat:{en:catEn, ar:catAr}, patient:{en:patEn, ar:patAr}, chips:ch, hcp:hcpObj};
  }
  function hcp(en, ar){ return {en, ar}; }
  function classRule(keys, catEn, catAr, patEn, patAr, ch=[]){
    return {keys: keys.map(normalize), cat:{en:catEn, ar:catAr}, patient:{en:patEn, ar:patAr}, chips:ch};
  }

  const MEDS = [
    entry(["warfarin","coumadin","ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ†","ÙƒÙˆÙ…Ø§Ø¯ÙŠÙ†"], "Anticoagulant", "Ù…Ø¶Ø§Ø¯ ØªØ®Ø«Ø±",
      "âœ… Take after Iftar at the same time daily.\nâ›” Do not change dose.\nğŸ“Œ INR monitoring as scheduled.",
      "âœ… Ø®Ø°Ù‡ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§.\nâ›” Ù„Ø§ ØªØºÙŠÙ‘Ø± Ø§Ù„Ø¬Ø±Ø¹Ø©.\nğŸ“Œ Ù…ØªØ§Ø¨Ø¹Ø© INR Ø­Ø³Ø¨ Ø§Ù„Ø®Ø·Ø©.",
      chips([{l:"danger",ar:"ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ† ÙŠØ­ØªØ§Ø¬ INR",en:"Warfarin needs INR monitoring"},{l:"warn",ar:"ØªØ¯Ø§Ø®Ù„Ø§Øª Ù…Ø¹ Ù…Ø¶Ø§Ø¯Ø§Øª/NSAIDs",en:"Interactions with antibiotics/NSAIDs"}]),
      hcp("Keep time consistent; monitor INR with diet/drug changes.","Ø«Ø¨Ù‘Øª ÙˆÙ‚Øª Ø§Ù„Ø¬Ø±Ø¹Ø© ÙˆØ±Ø§Ù‚Ø¨ INR Ù…Ø¹ Ø£ÙŠ ØªØºÙŠÙŠØ± ØºØ°Ø§Ø¦ÙŠ/Ø¯ÙˆØ§Ø¦ÙŠ.")
    ),

    entry(["apixaban","eliquis","Ø§Ø¨ÙŠÙƒØ³Ø§Ø¨Ø§Ù†","Ø¥Ù„ÙŠÙƒÙˆÙŠØ³","Ø§Ù„ÙŠÙƒÙˆÙŠØ³"], "Anticoagulant (DOAC)", "Ù…Ø¶Ø§Ø¯ ØªØ®Ø«Ø± (DOAC)",
      "âœ… Take at the same times daily.\nIf BID: after Iftar + after Suhoor.\nâ›” Do not double doses.\nâš  If missed dose: follow your prescribed instructions or ask your pharmacist.",
      "âœ… Ø®Ø°Ù‡ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§.\nØ¥Ø°Ø§ Ù…Ø±ØªÙŠÙ†: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ±.\nâ›” Ù„Ø§ ØªØ¶Ø§Ø¹Ù Ø§Ù„Ø¬Ø±Ø¹Ø©.\nâš  Ø¥Ø°Ø§ Ù†Ø³ÙŠØª Ø¬Ø±Ø¹Ø©: Ø§ØªØ¨Ø¹ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙˆØµÙØ© Ø£Ùˆ Ø§Ø³Ø£Ù„ Ø§Ù„ØµÙŠØ¯Ù„ÙŠ.",
      chips([{l:"warn",ar:"Ù„Ø§ ØªØ¶Ø§Ø¹Ù Ø§Ù„Ø¬Ø±Ø¹Ø©",en:"Do not double doses"},{l:"warn",ar:"ØªØ¬Ù†Ø¨ NSAIDs Ø¨Ø¯ÙˆÙ† Ø§Ø³ØªØ´Ø§Ø±Ø©",en:"Avoid NSAIDs unless advised"}])
    ),

    entry(["rivaroxaban","xarelto","Ø±ÙŠÙØ§Ø±ÙˆÙƒØ³Ø§Ø¨Ø§Ù†","Ø²Ø§Ø±Ù„ØªÙˆ","Ø²Ø§Ø±ÙŠÙ„ÙŠØªÙˆ"], "Anticoagulant (DOAC)", "Ù…Ø¶Ø§Ø¯ ØªØ®Ø«Ø± (DOAC)",
      "âœ… Take with food if instructed (some doses require food).\nOD: after Iftar.\nBID: after Iftar + after Suhoor.\nâš  Ask your pharmacist if your strength must be taken with food.",
      "âœ… Ø®Ø°Ù‡ Ù…Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù… Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¬Ø±Ø¹ØªÙƒ ØªØªØ·Ù„Ø¨ Ø°Ù„Ùƒ.\nÙ…Ø±Ø©: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±.\nÙ…Ø±ØªÙŠÙ†: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ±.\nâš  Ø§Ø³Ø£Ù„ Ø§Ù„ØµÙŠØ¯Ù„ÙŠ Ø¥Ù† ÙƒØ§Ù†Øª Ø¬Ø±Ø¹ØªÙƒ ÙŠØ¬Ø¨ Ø£Ù† ØªØ¤Ø®Ø° Ù…Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù….",
      chips([{l:"warn",ar:"Ø¨Ø¹Ø¶ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ù…Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù…",en:"Some strengths require food"}])
    ),

    entry(["dabigatran","pradaxa","Ø¯Ø§Ø¨ÙŠØºØ§ØªØ±Ø§Ù†","Ø¨Ø±Ø§Ø¯Ø§ÙƒØ³Ø§"], "Anticoagulant (DOAC)", "Ù…Ø¶Ø§Ø¯ ØªØ®Ø«Ø± (DOAC)",
      "âœ… Take at the same times daily. Swallow capsules whole.\nBID: after Iftar + after Suhoor.\nâ›” Do not open/crush capsules.",
      "âœ… Ø®Ø°Ù‡ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§. Ø§Ø¨ØªÙ„Ø¹ Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø© ÙƒØ§Ù…Ù„Ø©.\nÙ…Ø±ØªÙŠÙ†: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ±.\nâ›” Ù„Ø§ ØªÙØªØ­/ØªØ³Ø­Ù‚ Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø©.",
      chips([{l:"warn",ar:"Ø§Ø¨ØªÙ„Ø§Ø¹ Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø© ÙƒØ§Ù…Ù„Ø©",en:"Swallow capsule whole"}])
    ),

    entry(["aspirin","asa","Ø§Ø³Ø¨Ø±ÙŠÙ†","Ø£Ø³Ø¨Ø±ÙŠÙ†"], "Antiplatelet", "Ù…Ø¶Ø§Ø¯ ØµÙØ§Ø¦Ø­",
      "âœ… Usually take after Iftar with food.\nâš  Higher stomach irritation risk â†’ consider gastroprotection if prescribed.\nâ›” Do not stop without clinician advice (especially after stents).",
      "âœ… ØºØ§Ù„Ø¨Ù‹Ø§ ÙŠØ¤Ø®Ø° Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù…Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù….\nâš  Ù‚Ø¯ ÙŠÙ‡ÙŠÙ‘Ø¬ Ø§Ù„Ù…Ø¹Ø¯Ø© â†’ Ù‚Ø¯ ØªØ­ØªØ§Ø¬ ÙˆØ§Ù‚ÙŠ Ù…Ø¹Ø¯Ø© Ø­Ø³Ø¨ Ø§Ù„ÙˆØµÙØ©.\nâ›” Ù„Ø§ ØªÙˆÙ‚ÙÙ‡ Ø¨Ø¯ÙˆÙ† Ø§Ù„Ø·Ø¨ÙŠØ¨ (Ø®ØµÙˆØµÙ‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø¹Ø§Ù…Ø§Øª).",
      chips([{l:"warn",ar:"Ù…Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù…",en:"With food"},{l:"danger",ar:"Ù„Ø§ ØªÙˆÙ‚ÙÙ‡ Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø¹Ø§Ù…Ø©",en:"Do not stop after stent"}])
    ),

    entry(["clopidogrel","plavix","ÙƒÙ„ÙˆØ¨ÙŠØ¯ÙˆØºØ±ÙŠÙ„","Ø¨Ù„Ø§ÙÙŠÙƒØ³"], "Antiplatelet", "Ù…Ø¶Ø§Ø¯ ØµÙØ§Ø¦Ø­",
      "âœ… Take once daily at a consistent time (after Iftar is fine).\nâ›” Do not stop without clinician advice.",
      "âœ… Ø®Ø°Ù‡ Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ Ø¨ÙˆÙ‚Øª Ø«Ø§Ø¨Øª (Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù…Ù†Ø§Ø³Ø¨).\nâ›” Ù„Ø§ ØªÙˆÙ‚ÙÙ‡ Ø¨Ø¯ÙˆÙ† Ø§Ù„Ø·Ø¨ÙŠØ¨.",
      chips([{l:"danger",ar:"Ø¥ÙŠÙ‚Ø§ÙÙ‡ Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø®Ø·ÙŠØ±Ù‹Ø§",en:"Stopping can be dangerous"}])
    ),

    entry(["ticagrelor","brilinta","ØªÙŠÙƒØ§ØºØ±ÙŠÙ„ÙˆØ±","Ø¨Ø±ÙŠÙ„Ù†ØªØ§"], "Antiplatelet", "Ù…Ø¶Ø§Ø¯ ØµÙØ§Ø¦Ø­",
      "âœ… Usually BID: after Iftar + after Suhoor.\nâ›” Do not stop without clinician advice.",
      "âœ… ØºØ§Ù„Ø¨Ù‹Ø§ Ù…Ø±ØªÙŠÙ†: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ±.\nâ›” Ù„Ø§ ØªÙˆÙ‚ÙÙ‡ Ø¨Ø¯ÙˆÙ† Ø§Ù„Ø·Ø¨ÙŠØ¨.",
      chips([{l:"warn",ar:"Ù…Ø±ØªÙŠÙ† ÙŠÙˆÙ…ÙŠÙ‹Ø§",en:"Twice daily"}])
    ),

    entry(["insulin","Ø§Ù†Ø³ÙˆÙ„ÙŠÙ†","lantus","novorapid","humalog","mixtard","glargine","aspart"], "Diabetes", "Ø§Ù„Ø³ÙƒØ± â€“ Ø¥Ù†Ø³ÙˆÙ„ÙŠÙ†",
      "âš  Insulin needs an individualized Ramadan plan.\nâœ… Mealtime doses with Iftar & Suhoor; basal often evening.\nâ›” Do not change doses without clinician.\nğŸ“Œ Hypoglycemia symptoms â†’ break fast immediately.",
      "âš  Ø§Ù„Ø¥Ù†Ø³ÙˆÙ„ÙŠÙ† ÙŠØ­ØªØ§Ø¬ Ø®Ø·Ø© ÙØ±Ø¯ÙŠØ© Ù„Ø±Ù…Ø¶Ø§Ù†.\nâœ… Ø¬Ø±Ø¹Ø§Øª Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ù…Ø¹ Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆØ§Ù„Ø³Ø­ÙˆØ±Ø› Ø§Ù„Ù‚Ø§Ø¹Ø¯ÙŠ ØºØ§Ù„Ø¨Ù‹Ø§ Ù…Ø³Ø§Ø¡.\nâ›” Ù„Ø§ ØªØºÙŠÙ‘Ø± Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ø¨Ø¯ÙˆÙ† Ø§Ù„Ø·Ø¨ÙŠØ¨.\nğŸ“Œ Ø£Ø¹Ø±Ø§Ø¶ Ù‡Ø¨ÙˆØ· Ø§Ù„Ø³ÙƒØ± â†’ Ø§ÙØ·Ø± ÙÙˆØ±Ù‹Ø§.",
      chips([{l:"danger",ar:"Ø®Ø·Ø± Ù‡Ø¨ÙˆØ· Ø³ÙƒØ± Ø£Ø¹Ù„Ù‰",en:"Higher hypoglycemia risk"}])
    ),

    entry(["metformin","glucophage","Ù…ÙŠØªÙÙˆØ±Ù…ÙŠÙ†","Ø¬Ù„ÙˆÙƒÙˆÙØ§Ø¬"], "Diabetes (oral)", "Ø§Ù„Ø³ÙƒØ± (Ø£Ù‚Ø±Ø§Øµ)",
      "âœ… Take with meals.\nOD: with Iftar.\nBID: with Iftar + with Suhoor.\nâš  If GI upset, take mid-meal.",
      "âœ… Ø®Ø°Ù‡ Ù…Ø¹ Ø§Ù„ÙˆØ¬Ø¨Ø§Øª.\nÙ…Ø±Ø©: Ù…Ø¹ Ø§Ù„Ø¥ÙØ·Ø§Ø±.\nÙ…Ø±ØªÙŠÙ†: Ù…Ø¹ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ù…Ø¹ Ø§Ù„Ø³Ø­ÙˆØ±.\nâš  Ø¥Ø°Ø§ Ø³Ø¨Ø¨ Ø§Ø¶Ø·Ø±Ø§Ø¨ Ù…Ø¹Ø¯Ø© Ø®Ø°Ù‡ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ÙˆØ¬Ø¨Ø©.",
      chips([{l:"ok",ar:"Ù…Ø¹ Ø§Ù„Ø£ÙƒÙ„",en:"With meals"}])
    ),

    entry(["gliclazide","diamicron","Ø¬Ù„ÙŠÙƒÙ„Ø§Ø²Ø§ÙŠØ¯","Ø¯ÙŠØ§Ù…ÙŠÙƒØ±ÙˆÙ†"], "Diabetes (sulfonylurea)", "Ø§Ù„Ø³ÙƒØ± (Ø³Ù„ÙÙˆÙ†ÙŠÙ„ ÙŠÙˆØ±ÙŠØ§)",
      "âš  Risk of low sugar during fasting.\nâœ… Take with Iftar if once daily.\nâ›” Do not change dose without clinician.\nğŸ“Œ If dizziness/sweating/confusion â†’ check glucose and break fast.",
      "âš  Ø®Ø·Ø± Ù‡Ø¨ÙˆØ· Ø§Ù„Ø³ÙƒØ± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØµÙŠØ§Ù….\nâœ… Ø¥Ø°Ø§ Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ Ø®Ø°Ù‡ Ù…Ø¹ Ø§Ù„Ø¥ÙØ·Ø§Ø±.\nâ›” Ù„Ø§ ØªØºÙŠÙ‘Ø± Ø§Ù„Ø¬Ø±Ø¹Ø© Ø¨Ø¯ÙˆÙ† Ø§Ù„Ø·Ø¨ÙŠØ¨.\nğŸ“Œ Ø¥Ø°Ø§ Ø¯ÙˆØ®Ø©/ØªØ¹Ø±Ù‚/ØªØ´ÙˆØ´ â†’ Ø§ÙØ­Øµ Ø§Ù„Ø³ÙƒØ± ÙˆØ§ÙØ·Ø±.",
      chips([{l:"danger",ar:"Ø®Ø·Ø± Ù‡Ø¨ÙˆØ· Ø³ÙƒØ±",en:"Hypoglycemia risk"}])
    ),

    entry(["empagliflozin","jardiance","Ø§Ù…Ø¨Ø§ØºÙ„ÙŠÙÙ„ÙˆØ²ÙŠÙ†","Ø¬Ø§Ø±Ø¯ÙŠØ§Ù†Ø³"], "Diabetes (SGLT2i)", "Ø§Ù„Ø³ÙƒØ± (SGLT2)",
      "âš  Can increase dehydration risk.\nâœ… Prefer after Iftar with good fluid intake.\nğŸ“Œ Watch for dizziness, dark urine, or genital infections; seek advice.",
      "âš  Ù‚Ø¯ ÙŠØ²ÙŠØ¯ Ø®Ø·Ø± Ø§Ù„Ø¬ÙØ§Ù.\nâœ… ÙŠÙØ¶Ù‘Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù…Ø¹ Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙƒØ§ÙÙŠØ©.\nğŸ“Œ Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø¯ÙˆØ®Ø©/Ù‚Ù„Ø© Ø§Ù„Ø¨ÙˆÙ„/Ø§Ù„ØªÙ‡Ø§Ø¨Ø§ØªØ› Ø§Ø³ØªØ´Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©.",
      chips([{l:"warn",ar:"Ø§Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙƒÙØ§ÙŠØ©",en:"Maintain hydration"}])
    ),

    entry(["furosemide","lasix","ÙÙˆØ±ÙˆØ³ÙŠÙ…ÙŠØ¯","Ù„Ø§Ø²ÙŠÙƒØ³"], "Diuretic", "Ù…Ø¯Ø± Ø¨ÙˆÙ„",
      "âš  Take early after Iftar to reduce nighttime urination.\nâœ… Maintain hydration between Iftarâ€“Suhoor.\nâ›” If severe dizziness or very low BP â†’ seek advice.",
      "âš  Ø®Ø°Ù‡ Ù…Ø¨ÙƒØ±Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù„ØªÙ‚Ù„ÙŠÙ„ ÙƒØ«Ø±Ø© Ø§Ù„ØªØ¨ÙˆÙ„ Ù„ÙŠÙ„Ù‹Ø§.\nâœ… Ø§Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙƒÙØ§ÙŠØ© Ø¨ÙŠÙ† Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆØ§Ù„Ø³Ø­ÙˆØ±.\nâ›” Ø¥Ø°Ø§ Ø¯ÙˆØ®Ø© Ø´Ø¯ÙŠØ¯Ø©/Ø¶ØºØ· Ù…Ù†Ø®ÙØ¶ Ø¬Ø¯Ù‹Ø§ â†’ Ø§Ø³ØªØ´Ø±.",
      chips([{l:"warn",ar:"Ù…Ø¨ÙƒØ±Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±",en:"Early after Iftar"}])
    ),

    entry(["amlodipine","norvasc","Ø§Ù…Ù„ÙˆØ¯ÙŠØ¨ÙŠÙ†","Ù†ÙˆØ±ÙØ§Ø³Ùƒ"], "Blood pressure", "Ø¶ØºØ·",
      "âœ… OD: after Iftar or after Suhoor (consistent). If dizziness occurs, ask your clinician.",
      "âœ… Ù…Ø±Ø©: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø£Ùˆ Ø§Ù„Ø³Ø­ÙˆØ± (ÙˆÙ‚Øª Ø«Ø§Ø¨Øª). Ø¥Ø°Ø§ Ø­ØµÙ„Øª Ø¯ÙˆØ®Ø© Ø§Ø³ØªØ´Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨.",
      chips([{l:"warn",ar:"Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø¯ÙˆØ®Ø©",en:"Monitor dizziness"}])
    ),

    entry(["bisoprolol","concor","Ø¨ÙŠØ³ÙˆØ¨Ø±ÙˆÙ„ÙˆÙ„","ÙƒÙˆÙ†ÙƒÙˆØ±"], "Blood pressure / Heart", "Ø¶ØºØ· / Ù‚Ù„Ø¨",
      "âœ… OD: after Iftar or Suhoor (consistent).\nâ›” Do not stop suddenly.\nğŸ“Œ Monitor pulse; seek advice if very low.",
      "âœ… Ù…Ø±Ø©: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø£Ùˆ Ø§Ù„Ø³Ø­ÙˆØ± (ÙˆÙ‚Øª Ø«Ø§Ø¨Øª).\nâ›” Ù„Ø§ ØªÙˆÙ‚ÙÙ‡ ÙØ¬Ø£Ø©.\nğŸ“Œ Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù†Ø¨Ø¶Ø› Ø§Ø³ØªØ´Ø± Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ù†Ø®ÙØ¶Ù‹Ø§ Ø¬Ø¯Ù‹Ø§.",
      chips([{l:"warn",ar:"Ù„Ø§ ØªÙˆÙ‚ÙÙ‡ ÙØ¬Ø£Ø©",en:"Do not stop suddenly"}])
    ),

    entry(["omeprazole","pantoprazole","esomeprazole","ppi","Ø£ÙˆÙ…ÙŠØ¨Ø±Ø§Ø²ÙˆÙ„","Ø¨Ø§Ù†ØªÙˆØ¨Ø±Ø§Ø²ÙˆÙ„","Ø¥ÙŠØ²ÙˆÙ…ÙŠØ¨Ø±Ø§Ø²ÙˆÙ„"], "GI (PPI)", "Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…Ø¹Ø¯Ø© (PPI)",
      "âœ… Best 30â€“60 min before Iftar. Alternative: before Suhoor. If BID: before Iftar + before Suhoor.",
      "âœ… Ø§Ù„Ø£ÙØ¶Ù„ Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø± 30â€“60 Ø¯Ù‚ÙŠÙ‚Ø©. Ø¨Ø¯ÙŠÙ„: Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø­ÙˆØ±. Ø¥Ø°Ø§ Ù…Ø±ØªÙŠÙ†: Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø­ÙˆØ±.",
      chips([{l:"ok",ar:"Ù‚Ø¨Ù„ Ø§Ù„Ø£ÙƒÙ„ Ø£ÙØ¶Ù„",en:"Best before meals"}])
    ),

    entry(["famotidine","pepcid","ÙØ§Ù…ÙˆØªÙŠØ¯ÙŠÙ†","Ø¨ÙŠØ¨cid","Ø¨ÙŠØ¨Ø³Ø§ÙŠØ¯"], "GI (H2 blocker)", "Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…Ø¹Ø¯Ø© (H2)",
      "âœ… OD: after Iftar. BID: after Iftar + after Suhoor.\nâš  If symptoms persist, ask your clinician.",
      "âœ… Ù…Ø±Ø©: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±. Ù…Ø±ØªÙŠÙ†: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ±.\nâš  Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø±Øª Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ø³ØªØ´Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨.",
      chips([{l:"ok",ar:"ÙŠÙ…ÙƒÙ† Ø¨Ø¹Ø¯ Ø§Ù„Ø£ÙƒÙ„",en:"Can be after meals"}])
    ),

    entry(["levothyroxine","euthyrox","eltroxin","Ù„ÙŠÙÙˆØ«ÙŠØ±ÙˆÙƒØ³ÙŠÙ†","Ø«ÙŠØ±ÙˆÙƒØ³ÙŠÙ†"], "Endocrine", "Ø§Ù„ØºØ¯Ø© Ø§Ù„Ø¯Ø±Ù‚ÙŠØ©",
      "âœ… Take 30â€“60 min before Suhoor on empty stomach with water. Separate 4h from iron/calcium/antacids.",
      "âœ… Ø®Ø°Ù‡ Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø­ÙˆØ± 30â€“60 Ø¯Ù‚ÙŠÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ø¹Ø¯Ø© ÙØ§Ø±ØºØ© Ù…Ø¹ Ù…Ø§Ø¡. Ø§ÙØµÙ„ 4 Ø³Ø§Ø¹Ø§Øª Ø¹Ù† Ø§Ù„Ø­Ø¯ÙŠØ¯/Ø§Ù„ÙƒØ§Ù„Ø³ÙŠÙˆÙ…/Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ù…ÙˆØ¶Ø©.",
      chips([{l:"ok",ar:"Ø¹Ù„Ù‰ Ù…Ø¹Ø¯Ø© ÙØ§Ø±ØºØ©",en:"Empty stomach"}])
    ),

    entry(["prednisolone","prednisone","ÙƒÙˆØ±ØªÙŠØ²ÙˆÙ†","Ø¨Ø±ÙŠØ¯Ù†ÙŠØ²ÙˆÙ„ÙˆÙ†","Ø¨Ø±ÙŠØ¯Ù†ÙŠØ²ÙˆÙ†"], "Steroid", "ÙƒÙˆØ±ØªÙŠØ²ÙˆÙ†",
      "âš  Timing depends on indication.\nâœ… Often best with Iftar to reduce stomach upset.\nğŸ“Œ Do not stop suddenly if long-term. Ask clinician for Ramadan plan.",
      "âš  Ø§Ù„ØªÙˆÙ‚ÙŠØª ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¨Ø¨.\nâœ… ØºØ§Ù„Ø¨Ù‹Ø§ Ø§Ù„Ø£ÙØ¶Ù„ Ù…Ø¹ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù„ØªÙ‚Ù„ÙŠÙ„ ØªÙ‡ÙŠØ¬ Ø§Ù„Ù…Ø¹Ø¯Ø©.\nğŸ“Œ Ù„Ø§ ØªÙˆÙ‚ÙÙ‡ ÙØ¬Ø£Ø© Ø¥Ø°Ø§ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø·ÙˆÙŠÙ„. Ø§Ø·Ù„Ø¨ Ø®Ø·Ø© Ø±Ù…Ø¶Ø§Ù† Ù…Ù† Ø§Ù„Ø·Ø¨ÙŠØ¨.",
      chips([{l:"warn",ar:"Ù„Ø§ ØªÙˆÙ‚ÙÙ‡ ÙØ¬Ø£Ø©",en:"Do not stop suddenly"}])
    ),

    entry(["antibiotic","Ù…Ø¶Ø§Ø¯ Ø­ÙŠÙˆÙŠ","amoxicillin","augmentin","azithromycin","ciprofloxacin","amox","Ø£ÙˆØ¬Ù…Ù†ØªÙŠÙ†","Ø§Ø²ÙŠØ«Ø±ÙˆÙ…Ø§ÙŠØ³ÙŠÙ†","Ø³ÙŠØ¨Ø±ÙˆÙÙ„ÙˆÙƒØ³Ø§Ø³ÙŠÙ†"], "Antibiotic", "Ù…Ø¶Ø§Ø¯ Ø­ÙŠÙˆÙŠ",
      "âœ… If BID: after Iftar + after Suhoor. If OD: after Iftar. If TID/QID: ask for XR/BID alternative.\nâš  Some antibiotics have food/interaction instructions.",
      "âœ… Ø¥Ø°Ø§ Ù…Ø±ØªÙŠÙ†: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ±. Ø¥Ø°Ø§ Ù…Ø±Ø©: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±. Ø¥Ø°Ø§ 3/4 Ù…Ø±Ø§Øª: Ø§Ø·Ù„Ø¨ Ø¨Ø¯ÙŠÙ„ XR/BID.\nâš  Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø¶Ø§Ø¯Ø§Øª Ù„Ù‡Ø§ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù…Ø¹/Ø¨Ø¯ÙˆÙ† Ø·Ø¹Ø§Ù… ÙˆØªØ¯Ø§Ø®Ù„Ø§Øª.",
      chips([{l:"warn",ar:"Ø£ÙƒÙ…Ù„ Ø§Ù„ÙƒÙˆØ±Ø³",en:"Finish the course"}])
    ),

  ];

  const CLASS_RULES = [
    classRule(["blood pressure","antihypertensive","Ø¶ØºØ·","bp"], "Blood pressure meds", "Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø¶ØºØ·",
      "OD: after Iftar OR after Suhoor (consistent). Diuretics: early after Iftar.\nâš  If dizziness or very low BP â†’ seek advice.",
      "Ù…Ø±Ø©: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø£Ùˆ Ø§Ù„Ø³Ø­ÙˆØ± (ÙˆÙ‚Øª Ø«Ø§Ø¨Øª). Ø§Ù„Ù…Ø¯Ø±Ø§Øª: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù…Ø¨ÙƒØ±Ù‹Ø§.\nâš  Ø¥Ø°Ø§ Ø¯ÙˆØ®Ø© Ø£Ùˆ Ø¶ØºØ· Ù…Ù†Ø®ÙØ¶ Ø¬Ø¯Ù‹Ø§ â†’ Ø§Ø³ØªØ´Ø±.",
      chips([{l:"warn",ar:"Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø¯ÙˆØ®Ø©/Ø§Ù„Ø¶ØºØ·",en:"Monitor dizziness/BP"}])
    ),

    classRule(["diuretic","water pill","Ù…Ø¯Ø±","Ù…Ø¯Ø± Ø¨ÙˆÙ„"], "Diuretics", "Ù…Ø¯Ø±Ø§Øª Ø§Ù„Ø¨ÙˆÙ„",
      "Prefer early after Iftar. Maintain hydration between Iftarâ€“Suhoor. Ask clinician if edema/heart failure plan needed.",
      "ÙŠÙØ¶Ù„ Ù…Ø¨ÙƒØ±Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±. Ø§Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙƒÙØ§ÙŠØ© Ø¨ÙŠÙ† Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆØ§Ù„Ø³Ø­ÙˆØ±. Ø§Ø³ØªØ´Ø± Ù„Ù„Ø·ÙˆØ§Ø±Ø¦ Ø£Ùˆ Ø®Ø·Ø· ÙØ´Ù„ Ø§Ù„Ù‚Ù„Ø¨/Ø§Ù„Ø³ÙˆØ§Ø¦Ù„.",
      chips([{l:"warn",ar:"Ù…Ø¨ÙƒØ±Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±",en:"Early after Iftar"}])
    ),

    classRule(["ppi","Ù…Ø¹Ø¯Ø©","Ø§Ø±ØªØ¬Ø§Ø¹","reflux","gerd"], "PPI", "Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…Ø¹Ø¯Ø© (PPI)",
      "30â€“60 min before Iftar (best). If BID: before Iftar + before Suhoor.",
      "Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø± 30â€“60 Ø¯Ù‚ÙŠÙ‚Ø© (Ø§Ù„Ø£ÙØ¶Ù„). Ø¥Ø°Ø§ Ù…Ø±ØªÙŠÙ†: Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø­ÙˆØ±.",
      chips([{l:"ok",ar:"Ù‚Ø¨Ù„ Ø§Ù„Ø£ÙƒÙ„ Ø£ÙØ¶Ù„",en:"Best before meals"}])
    ),

    classRule(["antacid","maalox","gaviscon","Ù…Ø¶Ø§Ø¯ Ø­Ù…ÙˆØ¶Ø©","Ø¬Ø§ÙÙŠØ³ÙƒÙˆÙ†"], "Antacids", "Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ù…ÙˆØ¶Ø©",
      "Use between Iftarâ€“Suhoor as needed. Separate from other medicines by 2 hours (unless instructed).",
      "ØªÙØ³ØªØ®Ø¯Ù… Ø¨ÙŠÙ† Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆØ§Ù„Ø³Ø­ÙˆØ± Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©. Ø§ÙØµÙ„Ù‡Ø§ Ø¹Ù† Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø£Ø®Ø±Ù‰ Ø³Ø§Ø¹ØªÙŠÙ† (Ø¥Ù„Ø§ Ø¥Ø°Ø§ Ø£ÙˆØµÙŠ Ø¨ØºÙŠØ± Ø°Ù„Ùƒ).",
      chips([{l:"warn",ar:"Ø§ÙØµÙ„ Ø³Ø§Ø¹ØªÙŠÙ†",en:"Separate by 2 hours"}])
    ),

    classRule(["pain","analgesic","Ù…Ø³ÙƒÙ†","ibuprofen","diclofenac","naproxen","nsaid"], "Pain relief / NSAIDs", "Ù…Ø³ÙƒÙ†Ø§Øª / Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„Ø§Ù„ØªÙ‡Ø§Ø¨",
      "Paracetamol between Iftarâ€“Suhoor as needed.\nNSAIDs: take after Iftar with food; avoid with ulcers/CKD/warfarin unless advised.",
      "Ø¨Ø§Ø±Ø§Ø³ÙŠØªØ§Ù…ÙˆÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆØ§Ù„Ø³Ø­ÙˆØ± Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©.\nNSAIDs: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù…Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù…Ø› ØªØ¬Ù†Ø¨Ù‡Ø§ Ù…Ø¹ Ù‚Ø±Ø­Ø©/ÙƒÙ„Ù‰/ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ† Ø¥Ù„Ø§ Ø¨ØªÙˆØ¬ÙŠÙ‡.",
      chips([{l:"warn",ar:"Ù…Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù…",en:"With food"},{l:"warn",ar:"ØªØ¬Ù†Ø¨ Ù…Ø¹ ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ†",en:"Avoid with warfarin"}])
    ),

    classRule(["diabetes","Ø³ÙƒØ±","metformin","sglt2","sulfonylurea"], "Diabetes medicines", "Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø³ÙƒØ±ÙŠ",
      "Risk varies by medicine. If you have hypoglycemia risk (insulin/sulfonylurea) â†’ clinician plan is best.\nCheck glucose and break fast if low.",
      "Ø§Ù„Ø®Ø·Ø± ÙŠØ®ØªÙ„Ù Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ§Ø¡. Ø¥Ù† ÙƒØ§Ù† Ø®Ø·Ø± Ù‡Ø¨ÙˆØ· Ø³ÙƒØ± (Ø¥Ù†Ø³ÙˆÙ„ÙŠÙ†/Ø³Ù„ÙÙˆÙ†ÙŠÙ„ ÙŠÙˆØ±ÙŠØ§) â†’ Ø®Ø·Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø¶Ø±ÙˆØ±ÙŠØ©.\nØ§ÙØ­Øµ Ø§Ù„Ø³ÙƒØ± ÙˆØ§ÙØ·Ø± Ø¥Ø°Ø§ Ù…Ù†Ø®ÙØ¶.",
      chips([{l:"danger",ar:"Ø®Ø·Ø± Ù‡Ø¨ÙˆØ· Ø³ÙƒØ± Ù„Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©",en:"Hypoglycemia risk for some meds"}])
    ),

    classRule(["inhaler","asthma","copd","Ø¨Ø®Ø§Ø®","Ø±Ø¨Ùˆ"], "Inhalers", "Ø¨Ø®Ø§Ø®Ø§Øª",
      "Continue as prescribed. Do not delay treatment if severe symptoms.",
      "Ø§Ø³ØªÙ…Ø± Ø­Ø³Ø¨ Ø§Ù„ÙˆØµÙØ©. Ù„Ø§ ØªØ¤Ø®Ø± Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø¥Ø°Ø§ Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø´Ø¯ÙŠØ¯Ø©.",
      chips([{l:"warn",ar:"Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ù„Ù„Ø£Ù…Ø§Ù†",en:"Safety first"}])
    ),

    classRule(["antibiotic","abx","Ù…Ø¶Ø§Ø¯ Ø­ÙŠÙˆÙŠ"], "Antibiotics", "Ù…Ø¶Ø§Ø¯Ø§Øª Ø­ÙŠÙˆÙŠØ©",
      "If BID: after Iftar + after Suhoor. If TID/QID: ask for XR/BID alternative. Always finish the course.",
      "Ø¥Ø°Ø§ Ù…Ø±ØªÙŠÙ†: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ±. Ø¥Ø°Ø§ 3/4 Ù…Ø±Ø§Øª: Ø§Ø·Ù„Ø¨ Ø¨Ø¯ÙŠÙ„ XR/BID. Ø£ÙƒÙ…Ù„ Ø§Ù„ÙƒÙˆØ±Ø³.",
      chips([{l:"warn",ar:"Ø£ÙƒÙ…Ù„ Ø§Ù„ÙƒÙˆØ±Ø³",en:"Finish the course"}])
    ),

  ];

  let state = { pending: null };

  function findMed(q){
    const qq = normalize(q);
    if(!qq) return null;
    for(const m of MEDS){
      if(m.keys.some(k => qq===k)) return m;
    }
    for(const m of MEDS){
      if(m.keys.some(k => k.includes(qq) || qq.includes(k))) return m;
    }
    return null;
  }
  function findClass(q){
    const qq = normalize(q);
    if(!qq) return null;
    for(const c of CLASS_RULES){
      if(c.keys.some(k => qq.includes(k) || k.includes(qq))) return c;
    }
    return null;
  }

  function askFrequency(classHint=null){
    state.pending = {type:"freq", classHint};
    pushMsg(t(
      "To cover ALL medications safely, tell me the dosing frequency:\n1) Once daily (OD)\n2) Twice daily (BID)\n3) Three times daily (TID)\n4) Four times daily (QID)\n\nReply: 1 / 2 / 3 / 4",
      "Ù„ØªØºØ·ÙŠØ© ÙƒÙ„ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø¨Ø£Ù…Ø§Ù†ØŒ Ø­Ø¯Ù‘Ø¯ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§Øª Ø¨Ø§Ù„ÙŠÙˆÙ…:\n1) Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ (OD)\n2) Ù…Ø±ØªÙŠÙ† (BID)\n3) Ø«Ù„Ø§Ø« Ù…Ø±Ø§Øª (TID)\n4) Ø£Ø±Ø¨Ø¹ Ù…Ø±Ø§Øª (QID)\n\nØ§ÙƒØªØ¨: 1 Ø£Ùˆ 2 Ø£Ùˆ 3 Ø£Ùˆ 4"
    ));
  }

  function renderMed(m){
    const header = t(`ğŸ“Œ Category: ${m.cat.en}\n`, `ğŸ“Œ Ø§Ù„ØªØµÙ†ÙŠÙ: ${m.cat.ar}\n`);
    const body = (ui.mode.value==="hcp" && m.hcp)
      ? t("ğŸ§‘â€âš•ï¸ For HCP:\n" + m.hcp.en, "ğŸ§‘â€âš•ï¸ Ù„Ù„ÙƒÙˆØ§Ø¯Ø± Ø§Ù„ØµØ­ÙŠØ©:\n" + m.hcp.ar)
      : t(m.patient.ar, m.patient.en);
    pushMsg(header + "\n" + body, "bot", m.chips || []);
  }

  function renderClass(c){
    const header = t(`ğŸ“Œ Class: ${c.cat.en}\n`, `ğŸ“Œ Ø§Ù„ÙØ¦Ø©: ${c.cat.ar}\n`);
    pushMsg(header + "\n" + t(c.patient.ar, c.patient.en), "bot", c.chips || []);
    askFrequency(c.cat);
  }

  function handleFrequencyReply(q){
    const qq = normalize(q);
    const map = {"1":"od","od":"od","once":"od","Ù…Ø±Ø©":"od","2":"bid","bid":"bid","twice":"bid","Ù…Ø±ØªÙŠÙ†":"bid","3":"tid","tid":"tid","4":"qid","qid":"qid"};
    const f = map[qq];
    if(!f){ pushMsg(t("Reply 1/2/3/4.","Ø§ÙƒØªØ¨ 1/2/3/4."),"bot"); return; }
    const g = freqGuidance(f);
    const label = (state.pending && state.pending.classHint)
      ? t(`ğŸ“Œ Based on class: ${state.pending.classHint.en||""}\n`, `ğŸ“Œ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙØ¦Ø©: ${state.pending.classHint.ar||""}\n`)
      : "";
    pushMsg(label + "\n" + t(g.ar,g.en), "bot", g.chips||[]);
    state.pending = null;
  }

  function route(q){
    if(state.pending && state.pending.type==="freq"){ handleFrequencyReply(q); return; }
    const m = findMed(q); if(m){ renderMed(m); return; }
    const c = findClass(q); if(c){ renderClass(c); return; }
    pushMsg(t(
      "Not found by name. Type a class (antibiotic / PPI / blood pressure / inhaler / pain) OR reply with 1/2/3/4 for frequency.",
      "Ù„Ù… Ø£Ø¬Ø¯ Ø§Ù„Ø§Ø³Ù…. Ø§ÙƒØªØ¨ ÙØ¦Ø© (Ù…Ø¶Ø§Ø¯ Ø­ÙŠÙˆÙŠ / PPI / Ø¶ØºØ· / Ø¨Ø®Ø§Ø® / Ù…Ø³ÙƒÙ†) Ø£Ùˆ Ø§ÙƒØªØ¨ 1/2/3/4 Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§Øª."
    ),"bot");
    askFrequency();
  }

  const quick = ["warfarin","apixaban","rivaroxaban","dabigatran","aspirin","clopidogrel","ticagrelor","insulin","metformin","gliclazide","empagliflozin","furosemide","amlodipine","bisoprolol","levothyroxine","omeprazole","famotidine","prednisolone","antibiotic","blood pressure","diuretic","PPI","antacid","inhaler","pain","OD (1)","BID (2)","TID (3)","QID (4)"];
  function buildQuick(){
    ui.quick.innerHTML = "";
    quick.forEach(label=>{
      const b = document.createElement("div");
      b.className = "pill";
      b.textContent = label;
      b.onclick = ()=>{
        let v = label;
        if(label==="OD (1)") v="1";
        if(label==="BID (2)") v="2";
        if(label==="TID (3)") v="3";
        if(label==="QID (4)") v="4";
        pushMsg(v,"me");
        route(v);
    
      };
      ui.quick.appendChild(b);
    });
  }

  function welcome(){
    ui.chat.innerHTML = "";
    state.pending = null;
    pushMsg(t(
      "Ramadan Kareem ğŸŒ™\n\nWelcome to QCH Smart Ramadan Medication Assistant (v9).
Includes anticoagulants, diabetes meds, BP meds, GI meds, antibiotics, and more.\nType your medication name (Arabic/English).",
      "Ramadan Kareem ğŸŒ™\n\nØ£Ù‡Ù„Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù…Ø³Ø§Ø¹Ø¯ Ø£Ø¯ÙˆÙŠØ© Ø±Ù…Ø¶Ø§Ù† â€“ Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù‚Ø·ÙŠÙ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ (v8).
ÙŠØ´Ù…Ù„ Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„ØªØ®Ø«Ø±ØŒ Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø³ÙƒØ±ÙŠØŒ Ø§Ù„Ø¶ØºØ·ØŒ Ø§Ù„Ù…Ø¹Ø¯Ø©ØŒ Ø§Ù„Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„Ø­ÙŠÙˆÙŠØ©ØŒ ÙˆØºÙŠØ±Ù‡Ø§.\nØ§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ (Ø¹Ø±Ø¨ÙŠ/Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ)."
    ), "bot");
    ui.welcomeBox.textContent = t(
      "Ø¥Ø°Ø§ Ø§Ù„Ø¯ÙˆØ§Ø¡ 3/4 Ù…Ø±Ø§Øª â†’ Ø§Ø·Ù„Ø¨ Ø¨Ø¯ÙŠÙ„ XR/BID.",
      "Ø¥Ø°Ø§ Ø§Ù„Ø¯ÙˆØ§Ø¡ 3/4 Ù…Ø±Ø§Øª â†’ Ø§Ø·Ù„Ø¨ Ø¨Ø¯ÙŠÙ„ XR/BID."
    );

  }

  
  function setStatus(msg){
    if(ui.copyStatus) ui.copyStatus.textContent = msg || "";
  }

  function focusInput(){
    setTimeout(()=>{ try{ ui.input.focus(); }catch(e){} }, 50);
  }

  function send(){
    const q = ui.input.value;
    if(!q.trim()) return;
    pushMsg(q,"me");
    ui.input.value = "";
    route(q);

  }

  ui.send.addEventListener("click", send);
  ui.input.addEventListener("keydown", (e)=>{ if(e.key==="Enter"){ e.preventDefault(); send(); } });
  ui.reset.addEventListener("click", welcome);
  ui.mode.addEventListener("change", welcome);

  document.addEventListener("click", (e) => {
    // Don't steal focus when clicking controls or interactive elements
    if (e.target.closest(".controls")) return;
    if (e.target.closest("select, button, a, input, textarea, label")) return;

  }, { passive: true });


  if(ui.setLink){
    ui.setLink.addEventListener("click", ()=>{
      try{ ui.shareLink.value = window.location.href; setStatus(t("Link set to current page.","ØªÙ… Ø¶Ø¨Ø· Ø§Ù„Ø±Ø§Ø¨Ø· Ù„ØµÙØ­ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©.")); }catch(e){}
    });
  }
  if(ui.copyLink){
    ui.copyLink.addEventListener("click", async ()=>{
      try{
        const v = (ui.shareLink && ui.shareLink.value) ? ui.shareLink.value : window.location.href;
        await navigator.clipboard.writeText(v);
        setStatus(t("Copied âœ”","ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ”"));
      }catch(e){
        setStatus(t("Copy failed. Copy manually from the box.","ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®. Ø§Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ù…Ù† Ø§Ù„Ù…Ø±Ø¨Ø¹."));
      }
  
    });
  }

  buildQuick();
  applyDir();
  translateUI();
  welcome();
})();
</script>
</body>
</html>
