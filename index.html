<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ù…Ø³Ø§Ø¹Ø¯ Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ø°ÙƒÙŠ</title>
<style>
:root{
  --brand:#2f7fa3;
  --brand2:#67b3cf;
  --text:#0c2a36;

  --bgTop:#ffffff;
  --bg1:#eef8fd;
  --bg2:#dfeff8;

  --card:#f6fbff;
  --cardBorder:#bfe0f0;

  --shadow:0 18px 40px rgba(10, 42, 54, .08);

  /* Ù…Ø­Ø§Ø°Ø§Ø© Ø¨ØµØ±ÙŠØ© Ù„Ù„Ø´Ø¹Ø§Ø±Ø§Øª (ØªØ¹ÙˆÙŠØ¶ Ø§Ù„ÙØ±Ø§Øº Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ) */
  --logoBox:110px;
  --logoScaleQCH:1.00;
  --logoScaleHH:1.12;
  --logoYQCH:0px;
  --logoYHH:0px;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family: Tahoma, system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
  color:var(--text);
  background:
    linear-gradient(180deg, var(--bgTop) 0%, var(--bg1) 35%, var(--bg2) 100%);
}

/* ===== Header (white, minimal, like screenshot) ===== */
.header{
  background:#fff;
  padding:26px 28px 22px;
  border-bottom:1px solid rgba(47,127,163,.15);
}

.header-inner{
  max-width:1280px;
  margin:0 auto;
  position:relative;
  display:flex;
  align-items:flex-start;
  justify-content:center;
}

/* corner logos */
.logoCorner{
  position:absolute;
  top:2px;
  width:var(--logoBox);
  height:var(--logoBox);
  display:flex;
  align-items:center;
  justify-content:center;
}
.logoCorner.left{left:0;}
.logoCorner.right{right:0;}

.logoCorner img{
  max-width:100%;
  max-height:100%;
  width:auto;
  height:auto;
  object-fit:contain;
  display:block;
  transform-origin:center center;
}
.logoCorner.right img{
  transform: translateY(var(--logoYQCH)) scale(var(--logoScaleQCH));
}
.logoCorner.left img{
  transform: translateY(var(--logoYHH)) scale(var(--logoScaleHH));
}

/* centered title */
.title{
  text-align:center;
  padding: 6px 140px 0; /* leave room for logos on wide screens */
}
.title h1{
  margin:0;
  color:var(--brand);
  font-size:64px;
  letter-spacing:.2px;
  font-weight:800;
}
.title p{
  margin:10px 0 0;
  color:var(--brand2);
  font-size:34px;
  font-weight:700;
}

/* ===== Main area ===== */
.main{
  max-width:1400px;
  margin:0 auto;
  padding: 34px 22px 60px;
}

/* subtle big panel background behind card (like screenshot) */
.panel{
  background:rgba(255,255,255,.35);
  border:1px solid rgba(47,127,163,.12);
  border-radius:26px;
  padding: 34px;
  box-shadow: 0 10px 24px rgba(10,42,54,.05);
}

/* chat card */
.card{
  background:var(--card);
  border:2px solid var(--cardBorder);
  border-radius:24px;
  box-shadow: var(--shadow);
  padding: 34px 34px 26px;
  min-height: 520px;
}

.welcome{
  display:flex;
  align-items:center;
  justify-content:flex-start;
  gap:10px;
  font-size:34px;
  font-weight:800;
  color:#0b2b38;
  margin: 4px 0 22px;
}
.welcome .hand{font-size:28px;}

.prompt{
  font-size:30px;
  line-height:1.7;
  color:#123a4a;
  font-weight:650;
  margin:0 0 24px;
}

/* input row */
.inputRow{
  margin-top: 26px;
  display:flex;
  gap:14px;
  align-items:center;
}
.inputRow input{
  flex:1;
  height:60px;
  border-radius:14px;
  border:1px solid rgba(47,127,163,.25);
  padding: 0 18px;
  font-size:20px;
  outline:none;
  background:#fff;
}
.inputRow button{
  height:60px;
  padding:0 24px;
  border-radius:14px;
  border:0;
  background:var(--brand2);
  color:#053041;
  font-size:18px;
  font-weight:800;
  cursor:pointer;
}
.inputRow button:hover{filter:brightness(.97);}

#chatBox{
  min-height: 320px;
}

/* responsive */
@media (max-width: 980px){
  :root{ --logoBox:90px; }
  .title{ padding: 4px 110px 0; }
  .title h1{ font-size:44px; }
  .title p{ font-size:24px; }
  .card{ min-height: 460px; }
  .welcome{ font-size:28px; }
  .prompt{ font-size:22px; }
}
@media (max-width: 640px){
  :root{ --logoBox:74px; }
  .header{ padding:18px 16px 16px; }
  .title{ padding: 0 86px; }
  .title h1{ font-size:34px; }
  .title p{ font-size:20px; }
  .panel{ padding:18px; }
  .card{ padding:18px; }
  .inputRow{ flex-direction:column; }
  .inputRow input, .inputRow button{ width:100%; }
}

/* ===== Premium micro-animations ===== */
.title h1, .title p{
  opacity:0;
  transform: translateY(18px);
  animation: fadeRise 1.1s cubic-bezier(.2,.8,.2,1) forwards;
  will-change: transform, opacity;
}
.title p{ animation-delay:.35s; }
@keyframes fadeRise{ to{ opacity:1; transform: translateY(0);} }

/* subtle header shine */
.header::after{
  content:"";
  position:absolute;
  inset:0;
  background: linear-gradient(90deg, transparent, rgba(103,179,207,.08), transparent);
  transform: translateX(-100%);
  animation: shine 3.6s ease-in-out 1.2s forwards;
  pointer-events:none;
}
.header{ position:relative; overflow:hidden; }
@keyframes shine{ 40%{transform:translateX(100%);} 100%{transform:translateX(100%);} }

/* ===== Ramadan crescent (very subtle) ===== */
body::before{
  content:"";
  position:fixed;
  top:12%;
  left:6%;
  width:340px;
  height:340px;
  background:
    radial-gradient(circle at 42% 42%, #ffffff 60%, transparent 61%),
    radial-gradient(circle at 56% 46%, rgba(103,179,207,.9) 60%, transparent 61%);
  opacity:.055;
  filter: blur(.2px);
  pointer-events:none;
  z-index:0;
}
body::after{
  content:"";
  position:fixed;
  bottom:8%;
  right:7%;
  width:260px;
  height:260px;
  background:
    radial-gradient(circle at 42% 42%, #ffffff 60%, transparent 61%),
    radial-gradient(circle at 56% 46%, rgba(47,127,163,.95) 60%, transparent 61%);
  opacity:.04;
  filter: blur(.3px);
  pointer-events:none;
  z-index:0;
}

/* keep content above background */
.header, .main{ position:relative; z-index:1; }

/* ===== Chat UI upgrades ===== */
.chat{
  display:flex;
  flex-direction:column;
  gap:12px;
  margin: 6px 0 18px;
}
.bubble{
  max-width:min(760px, 92%);
  padding:14px 16px;
  border-radius:16px;
  line-height:1.75;
  font-size:18px;
  box-shadow: 0 10px 22px rgba(10,42,54,.06);
  border:1px solid rgba(47,127,163,.14);
  background:#fff;
}
.bubble.user{
  align-self:flex-start;
  background: linear-gradient(180deg, rgba(103,179,207,.18), rgba(103,179,207,.10));
}
.bubble.bot{
  align-self:flex-end;
  background: linear-gradient(180deg, rgba(47,127,163,.12), rgba(47,127,163,.06));
}
.bubble small{ display:block; opacity:.75; margin-top:8px; }

.toolbar{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  align-items:center;
  justify-content:space-between;
  margin: 6px 0 18px;
}
.pills{
  display:flex; flex-wrap:wrap; gap:10px;
}
.pill{
  border:1px solid rgba(47,127,163,.20);
  background:#fff;
  border-radius:999px;
  padding:10px 14px;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
  transition: transform .06s ease, filter .2s ease;
}
.pill:hover{ filter:brightness(.98); }
.pill:active{ transform:scale(.98); }

.langToggle{
  display:flex;
  border:1px solid rgba(47,127,163,.22);
  border-radius:999px;
  overflow:hidden;
  background:#fff;
}
.langToggle button{
  border:0;
  background:transparent;
  padding:10px 14px;
  font-size:14px;
  font-weight:800;
  cursor:pointer;
  color:var(--text);
}
.langToggle button.active{
  background: rgba(103,179,207,.22);
}

.hint{
  margin: 0 0 8px;
  color:#1a4a5f;
  opacity:.85;
  font-size:16px;
  font-weight:650;
}

/* input row polish */
.inputRow input{
  box-shadow: 0 8px 18px rgba(10,42,54,.05);
}
.inputRow button{
  box-shadow: 0 10px 22px rgba(10,42,54,.08);
}

/* better mobile */
@media (max-width: 640px){
  .card{ min-height:auto; }
  #chatBox{ min-height: 180px; }
  .bubble{ font-size:16px; }
  .title{ padding: 0 84px; }
  .title h1{ font-size:32px; }
  .title p{ font-size:18px; }
  .welcome{ font-size:22px; }
  .prompt{ font-size:18px; }
  .pill{ font-size:14px; padding:9px 12px; }
}

</style>
</head>

<body>
  <header class="header">
    <div class="header-inner">
      <div class="logoCorner left" aria-label="Health Holding Co">
        <img src="logo_health_holding.png" alt="Health Holding Co" />
      </div>

      <div class="title">
        <h1>Ù…Ø³Ø§Ø¹Ø¯ Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ø°ÙƒÙŠ</h1>
        <p>Ù„ØªØ¹Ø¯ÙŠÙ„ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¬Ø±Ø¹Ø§Øª</p>
      </div>

      <div class="logoCorner right" aria-label="Qatif Central Hospital">
        <img src="logo_qch.png" alt="Qatif Central Hospital" />
      </div>
    </div>
  </header>

  <main class="main">
    <section class="panel">
      <section class="card">
        <div id="chatBox">
          <div class="welcome"><span>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ</span><span class="hand">ğŸ‘‹</span></div>
          <p class="prompt">Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ Ù„Ù…Ø¹Ø±ÙØ© Ø·Ø±ÙŠÙ‚Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ø±Ù…Ø¶Ø§Ù†.</p>
        </div>

        <div class="inputRow">
          <button type="button" onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
          <input id="userInput" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ Ù‡Ù†Ø§..." autocomplete="off" />
        </div>
      </section>
    </section>
  </main>

<script>
function esc(s){
  return (s||"").replace(/[&<>"]/g, c => ({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;" }[c]));
}
function sendMessage(){
  const input = document.getElementById("userInput");
  const chat = document.getElementById("chatBox");
  const v = (input.value||"").trim();
  if(!v) return;

  chat.insertAdjacentHTML("beforeend",
    `<div style="margin-top:18px;font-size:18px;color:#0b2b38;"><b>Ø£Ù†Øª:</b> ${esc(v)}</div>` +
    `<div style="margin-top:8px;font-size:18px;color:#123a4a;"><b>Ø§Ù„Ù†Ø¸Ø§Ù…:</b> ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡. (ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø· Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§Ø­Ù‚Ø§Ù‹)</div>`
  );
  input.value = "";
  window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
}
document.addEventListener("keydown", (e)=>{
  if(e.key==="Enter") sendMessage();
});
</script>

<script>
(() => {
  // ===== Language =====
  const LANG = { AR:"ar", EN:"en" };
  let lang = LANG.AR;

  const el = {
    input: document.querySelector(".inputRow input"),
    send: document.querySelector(".inputRow button"),
    chat: document.getElementById("chatBox"),
    hint: document.getElementById("hintLine"),
    btnTop: document.getElementById("btnTop"),
    btnExamples: document.getElementById("btnExamples"),
    btnClear: document.getElementById("btnClear"),
    langAR: document.getElementById("langAR"),
    langEN: document.getElementById("langEN"),
  };

  // ===== Real-ish medication knowledge base (offline) =====
  // Note: This is general education, not individualized medical advice.
  const DB = [
    // diabetes
    {key:"metformin", ar:"Ù…ÙŠØªÙÙˆØ±Ù…ÙŠÙ†", en:"Metformin", tags:["metformin","Ù…ÙŠØªÙÙˆØ±Ù…ÙŠÙ†","glucophage","Ø¬Ù„ÙˆÙƒÙˆÙØ§Ø¬"], class:"Diabetes (T2DM)", advice:{
      ar:"ØºØ§Ù„Ø¨Ù‹Ø§ ÙŠØ¤Ø®Ø° Ù…Ø¹/Ø¨Ø¹Ø¯ Ø§Ù„ÙˆØ¬Ø¨Ø© Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ø¶Ø·Ø±Ø§Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ø©. ÙÙŠ Ø±Ù…Ø¶Ø§Ù†: Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¬Ø±Ø¹Ø© Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ ÙØºØ§Ù„Ø¨Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±. Ø¥Ø°Ø§ Ù…Ø±ØªÙŠÙ† ÙŠÙˆÙ…ÙŠÙ‹Ø§ ÙØºØ§Ù„Ø¨Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆØ¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ±. Ø¥Ø°Ø§ Ù„Ø¯ÙŠÙƒ Ù‡Ø¨ÙˆØ· Ø³ÙƒØ± Ù…ØªÙƒØ±Ø± Ø£Ùˆ Ù…Ø±Ø¶ ÙƒÙ„ÙˆÙŠâ€”Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø®Ø·Ø©.",
      en:"Usually taken with/after food to reduce GI upset. In Ramadan: once daily often after Iftar; twice daily often after Iftar and Suhoor. If you have recurrent hypoglycemia or kidney disease, consult your clinician for a tailored plan."
    }},
    {key:"insulin", ar:"Ø£Ù†Ø³ÙˆÙ„ÙŠÙ†", en:"Insulin", tags:["insulin","Ø£Ù†Ø³ÙˆÙ„ÙŠÙ†","lantus","levemir","novorapid","humalog","apidra","tresiba","Ù†ÙˆÙÙˆØ±Ø§Ø¨ÙŠØ¯","Ù‡ÙŠÙˆÙ…Ø§Ù„ÙˆØ¬","Ø£Ø¨ÙŠØ¯Ø±Ø§","ØªØ±ÙŠØ³ÙŠØ¨Ø§","Ù„Ø§Ù†ØªÙˆØ³"], class:"Diabetes", highRisk:true, advice:{
      ar:"âš ï¸ Ø§Ù„Ø£Ù†Ø³ÙˆÙ„ÙŠÙ† ÙŠØ­ØªØ§Ø¬ Ø®Ø·Ø© ÙØ±Ø¯ÙŠØ© Ù‚Ø¨Ù„ Ø±Ù…Ø¶Ø§Ù†. Ù„Ø§ ØªØºÙŠÙ‘Ø± Ø§Ù„Ø¬Ø±Ø¹Ø© Ø¨Ù†ÙØ³Ùƒ. ØºØ§Ù„Ø¨Ù‹Ø§ ØªÙØ¹Ø¯Ù‘Ù„ Ø¬Ø±Ø¹Ø§Øª Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø±/Ø§Ù„Ø³Ø­ÙˆØ± Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø£Ù†Ø³ÙˆÙ„ÙŠÙ† ÙˆØ³ÙƒØ± Ø§Ù„Ø¯Ù…. Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø³ÙƒØ± Ø¨Ø§Ù†ØªØ¸Ø§Ù… ÙˆØ®Ø° Ø§Ø­ØªÙŠØ§Ø·Ø§Øª Ø§Ù„Ù‡Ø¨ÙˆØ·.",
      en:"âš ï¸ Insulin dosing must be individualized for Ramadanâ€”do not adjust on your own. Doses before Iftar/Suhoor often need modification depending on insulin type and glucose readings. Monitor closely and follow your care teamâ€™s plan."
    }},
    {key:"gliclazide", ar:"Ø¬Ù„ÙŠÙƒÙ„Ø§Ø²Ø§ÙŠØ¯", en:"Gliclazide", tags:["gliclazide","Ø¬Ù„ÙŠÙƒÙ„Ø§Ø²Ø§ÙŠØ¯","diamicron","Ø¯ÙŠØ§Ù…ÙŠÙƒØ±ÙˆÙ†"], class:"Diabetes (sulfonylurea)", highRisk:true, advice:{
      ar:"âš ï¸ Ù‚Ø¯ ÙŠØ³Ø¨Ø¨ Ù‡Ø¨ÙˆØ· Ø³ÙƒØ±. ØºØ§Ù„Ø¨Ù‹Ø§ ØªÙÙ†Ù‚Ù„ Ø§Ù„Ø¬Ø±Ø¹Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆÙ‚Ø¯ ØªÙØ®ÙÙ‘Ø¶. Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø³ÙƒØ± ÙˆØ±Ø§Ø¬Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø®ØµÙˆØµÙ‹Ø§ Ø¥Ø°Ø§ Ø­Ø¯Ø«Øª Ø£Ø¹Ø±Ø§Ø¶ Ù‡Ø¨ÙˆØ·.",
      en:"âš ï¸ Can cause hypoglycemia. Often the main dose is moved to Iftar and may be reduced. Monitor glucose and consult your clinician if lows occur."
    }},
    // anticoag
    {key:"warfarin", ar:"ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ†", en:"Warfarin", tags:["warfarin","ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ†","coumadin","ÙƒÙˆÙ…Ø§Ø¯ÙŠÙ†"], class:"Anticoagulant", highRisk:true, advice:{
      ar:"ÙŠÙ…ÙƒÙ† ØªÙ†Ø§ÙˆÙ„Ù‡ Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙÙŠ ÙˆÙ‚Øª Ø«Ø§Ø¨Øª. Ø§Ù„Ø£Ù‡Ù…: Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„ØªÙˆÙ‚ÙŠØª ÙŠÙˆÙ…ÙŠÙ‹Ø§ + Ù…ØªØ§Ø¨Ø¹Ø© INR Ø­Ø³Ø¨ Ø§Ù„Ø®Ø·Ø©. ØªØ¬Ù†Ù‘Ø¨ ØªØºÙŠÙŠØ±Ø§Øª ÙƒØ¨ÙŠØ±Ø© ÙÙŠ Ø§Ù„Ø£ØºØ°ÙŠØ© Ø§Ù„ØºÙ†ÙŠØ© Ø¨ÙÙŠØªØ§Ù…ÙŠÙ† K Ø¯ÙˆÙ† Ø§Ø³ØªØ´Ø§Ø±Ø©.",
      en:"Can be taken once daily after Iftar at a consistent time. Key: keep timing consistent and monitor INR as scheduled. Avoid major changes in vitamin Kâ€“rich foods without guidance."
    }},
    {key:"apixaban", ar:"Ø£Ø¨ÙŠÙƒØ³Ø§Ø¨Ø§Ù†", en:"Apixaban", tags:["apixaban","eliquis","Ø¥Ù„ÙŠÙƒÙˆÙŠØ³","Ø£Ø¨ÙŠÙƒØ³Ø§Ø¨Ø§Ù†"], class:"Anticoagulant", highRisk:true, advice:{
      ar:"Ø¥Ø°Ø§ Ù…Ø±ØªÙŠÙ† ÙŠÙˆÙ…ÙŠÙ‹Ø§: ØºØ§Ù„Ø¨Ù‹Ø§ Ø¬Ø±Ø¹Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆØ¬Ø±Ø¹Ø© Ù‚Ø¨Ù„/Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­ÙˆØ± Ø¨ÙˆÙ‚Øª Ù…Ù†Ø§Ø³Ø¨. Ù„Ø§ ØªÙˆÙ‚Ù Ø§Ù„Ø¯ÙˆØ§Ø¡ Ø¯ÙˆÙ† Ø·Ø¨ÙŠØ¨.",
      en:"If twice daily: often after Iftar and around Suhoor. Do not stop without clinician advice."
    }},
    {key:"rivaroxaban", ar:"Ø±ÙŠÙØ§Ø±ÙˆÙƒØ³Ø§Ø¨Ø§Ù†", en:"Rivaroxaban", tags:["rivaroxaban","xarelto","Ø²Ø§Ø±ÙŠÙ„ØªÙˆ","Ø±ÙŠÙØ§Ø±ÙˆÙƒØ³Ø§Ø¨Ø§Ù†"], class:"Anticoagulant", highRisk:true, advice:{
      ar:"Ø¨Ø¹Ø¶ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª ØªØ­ØªØ§Ø¬ Ù…Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù…. ÙÙŠ Ø±Ù…Ø¶Ø§Ù† ØºØ§Ù„Ø¨Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù…Ø¹ ÙˆØ¬Ø¨Ø©. Ø§ØªØ¨Ø¹ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¬Ø±Ø¹Ø© Ø§Ù„ØªÙŠ Ù„Ø¯ÙŠÙƒ ÙˆÙ„Ø§ ØªØºÙŠÙ‘Ø±Ù‡Ø§ Ø¯ÙˆÙ† Ø·Ø¨ÙŠØ¨.",
      en:"Some doses require food. In Ramadan often taken after Iftar with a meal. Follow your prescribed dosing instructions."
    }},
    // stomach
    {key:"omeprazole", ar:"Ø£ÙˆÙ…ÙŠØ¨Ø±Ø§Ø²ÙˆÙ„", en:"Omeprazole", tags:["omeprazole","Ø£ÙˆÙ…ÙŠØ¨Ø±Ø§Ø²ÙˆÙ„","losec","Ù„ÙˆØ³ÙŠÙƒ"], class:"PPI", advice:{
      ar:"Ø£ÙØ¶Ù„ ÙØ¹Ø§Ù„ÙŠØ© Ø¹Ù†Ø¯ ØªÙ†Ø§ÙˆÙ„Ù‡ Ø¹Ù„Ù‰ Ù…Ø¹Ø¯Ø© ÙØ§Ø±ØºØ© Ù‚Ø¨Ù„ Ø§Ù„Ø£ÙƒÙ„ Ø¨Ù€ 30â€“60 Ø¯Ù‚ÙŠÙ‚Ø©. ÙÙŠ Ø±Ù…Ø¶Ø§Ù†: Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø¨Ù†ØµÙ Ø³Ø§Ø¹Ø© Ù…Ù†Ø§Ø³Ø¨.",
      en:"Best taken on an empty stomach 30â€“60 minutes before a meal. In Ramadan: ~30 minutes before Iftar works well."
    }},
    {key:"pantoprazole", ar:"Ø¨Ø§Ù†ØªÙˆØ¨Ø±Ø§Ø²ÙˆÙ„", en:"Pantoprazole", tags:["pantoprazole","Ø¨Ø§Ù†ØªÙˆØ¨Ø±Ø§Ø²ÙˆÙ„","controloc","ÙƒÙˆÙ†ØªØ±ÙˆÙ„ÙˆÙƒ"], class:"PPI", advice:{
      ar:"Ù…Ø«Ù„ Ø§Ù„Ø£ÙˆÙ…ÙŠØ¨Ø±Ø§Ø²ÙˆÙ„: Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø¨Ù€ 30â€“60 Ø¯Ù‚ÙŠÙ‚Ø©.",
      en:"Similar to omeprazole: take 30â€“60 minutes before Iftar."
    }},
    {key:"famotidine", ar:"ÙØ§Ù…ÙˆØªÙŠØ¯ÙŠÙ†", en:"Famotidine", tags:["famotidine","ÙØ§Ù…ÙˆØªÙŠØ¯ÙŠÙ†","pepcid","Ø¨ÙŠØ¨cid","Ø¨ÙŠØ¨Ø³Ø§ÙŠØ¯"], class:"H2 blocker", advice:{
      ar:"ÙŠÙ…ÙƒÙ† ØªÙ†Ø§ÙˆÙ„Ù‡ Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø£Ùˆ Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ… Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©. Ø¹Ø§Ø¯Ø© Ù„Ø§ ÙŠØ­ØªØ§Ø¬ Ù…Ø¹Ø¯Ø© ÙØ§Ø±ØºØ©.",
      en:"Can be taken before Iftar or at bedtime depending on symptoms; usually does not require an empty stomach."
    }},
    // blood pressure / heart
    {key:"amlodipine", ar:"Ø£Ù…Ù„ÙˆØ¯ÙŠØ¨ÙŠÙ†", en:"Amlodipine", tags:["amlodipine","Ø£Ù…Ù„ÙˆØ¯ÙŠØ¨ÙŠÙ†","norvasc","Ù†ÙˆØ±ÙØ§Ø³Ùƒ"], class:"Hypertension", advice:{
      ar:"ØºØ§Ù„Ø¨Ù‹Ø§ Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§â€”ÙŠÙ…ÙƒÙ† Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø£Ùˆ Ø§Ù„Ø³Ø­ÙˆØ± ÙÙŠ ÙˆÙ‚Øª Ø«Ø§Ø¨Øª. Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø¶ØºØ· Ø®ØµÙˆØµÙ‹Ø§ Ø£ÙˆÙ„ Ø£ÙŠØ§Ù… Ø±Ù…Ø¶Ø§Ù†.",
      en:"Usually once dailyâ€”take after Iftar or Suhoor at a consistent time. Monitor BP especially early in Ramadan."
    }},
    {key:"lisinopril", ar:"Ù„ÙŠØ²ÙŠÙ†ÙˆØ¨Ø±ÙŠÙ„", en:"Lisinopril", tags:["lisinopril","Ù„ÙŠØ²ÙŠÙ†ÙˆØ¨Ø±ÙŠÙ„","zestril","Ø²ÙŠØ³ØªØ±ÙŠÙ„"], class:"ACE inhibitor", advice:{
      ar:"Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ ØºØ§Ù„Ø¨Ù‹Ø§. Ù‚Ø¯ ÙŠØ³Ø¨Ø¨ Ø¯ÙˆØ®Ø© Ù…Ø¹ Ø§Ù„Ø¬ÙØ§ÙØ› Ø§Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙƒØ§ÙÙŠØ© Ø¨ÙŠÙ† Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆØ§Ù„Ø³Ø­ÙˆØ± ÙˆØ±Ø§Ù‚Ø¨ Ø§Ù„Ø¶ØºØ·.",
      en:"Often once daily. Can cause dizziness with dehydrationâ€”hydrate between Iftar and Suhoor and monitor BP."
    }},
    {key:"losartan", ar:"Ù„ÙˆØ³Ø§Ø±ØªØ§Ù†", en:"Losartan", tags:["losartan","Ù„ÙˆØ³Ø§Ø±ØªØ§Ù†","cozaar","ÙƒÙˆØ²Ø§Ø±"], class:"ARB", advice:{
      ar:"Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ ØºØ§Ù„Ø¨Ù‹Ø§. Ø§Ø®ØªØ± ÙˆÙ‚Øª Ø«Ø§Ø¨Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø£Ùˆ Ø§Ù„Ø³Ø­ÙˆØ±.",
      en:"Often once dailyâ€”choose a consistent time after Iftar or Suhoor."
    }},
    {key:"furosemide", ar:"ÙÙˆØ±ÙˆØ³ÙŠÙ…ÙŠØ¯", en:"Furosemide", tags:["furosemide","lasix","Ù„Ø§Ø²ÙŠÙƒØ³","ÙÙˆØ±ÙˆØ³ÙŠÙ…ÙŠØ¯"], class:"Diuretic", highRisk:true, advice:{
      ar:"âš ï¸ Ù…ÙØ¯Ø±Ù‘ Ø¨ÙˆÙ„ ÙˆÙ‚Ø¯ ÙŠØ²ÙŠØ¯ Ø§Ù„Ø¹Ø·Ø´/Ø§Ù„Ø¬ÙØ§Ù. ØºØ§Ù„Ø¨Ù‹Ø§ ÙŠÙÙØ¶Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± (ÙˆØªØ¬Ù†Ø¨ Ù‚Ø±Ø¨ Ø§Ù„Ø³Ø­ÙˆØ±) Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙ„ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØµÙŠØ§Ù…. Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø¥Ø°Ø§ Ù„Ø¯ÙŠÙƒ Ù‚ØµÙˆØ± Ù‚Ù„Ø¨/ÙƒÙ„ÙŠØ©.",
      en:"âš ï¸ Diureticâ€”may worsen dehydration. Often preferred after Iftar (avoid close to Suhoor) to reduce daytime urination. Consult your clinician if you have HF/CKD."
    }},
    // antibiotics common (general)
    {key:"amoxicillin", ar:"Ø£Ù…ÙˆÙƒØ³ÙŠØ³ÙŠÙ„ÙŠÙ†", en:"Amoxicillin", tags:["amoxicillin","Ø£Ù…ÙˆÙƒØ³ÙŠØ³ÙŠÙ„ÙŠÙ†","amoxil","Ø£Ù…ÙˆÙƒØ³ÙŠÙ„"], class:"Antibiotic", advice:{
      ar:"Ø§ØªØ¨Ø¹ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ø§Ù„Ù…ÙˆØµÙˆÙØ© (Ù‚Ø¯ ØªÙƒÙˆÙ† 2â€“3 Ù…Ø±Ø§Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§). ÙÙŠ Ø±Ù…Ø¶Ø§Ù† ÙŠÙ…ÙƒÙ† ØªÙˆØ²ÙŠØ¹Ù‡Ø§ Ø¨ÙŠÙ† Ø§Ù„Ø¥ÙØ·Ø§Ø± ÙˆØ§Ù„Ø³Ø­ÙˆØ±. Ù„Ø§ ØªÙˆÙ‚Ù Ø§Ù„Ù…Ø¶Ø§Ø¯ Ù‚Ø¨Ù„ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ø¯Ø© Ø¥Ù„Ø§ Ø¨ØªÙˆØ¬ÙŠÙ‡ Ø·Ø¨ÙŠ.",
      en:"Follow prescribed dosing (often 2â€“3 times/day). In Ramadan, space doses between Iftar and Suhoor. Do not stop early unless advised."
    }},
    {key:"azithromycin", ar:"Ø£Ø²ÙŠØ«Ø±ÙˆÙ…ÙŠØ³ÙŠÙ†", en:"Azithromycin", tags:["azithromycin","Ø£Ø²ÙŠØ«Ø±ÙˆÙ…ÙŠØ³ÙŠÙ†","zithromax","Ø²ÙŠØ«Ø±ÙˆÙ…ÙƒØ³"], class:"Antibiotic", advice:{
      ar:"ØºØ§Ù„Ø¨Ù‹Ø§ Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§. Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ ØªÙØ¤Ø®Ø° Ø¨Ø¹ÙŠØ¯Ù‹Ø§ Ø¹Ù† Ø§Ù„Ø·Ø¹Ø§Ù…â€”Ø§ØªØ¨Ø¹ Ù…Ù„ØµÙ‚ Ø§Ù„Ø¹Ø¨ÙˆØ©. ÙˆÙ‚Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± ØºØ§Ù„Ø¨Ù‹Ø§ Ù…Ù†Ø§Ø³Ø¨.",
      en:"Often once daily. Some forms are taken away from foodâ€”follow your label. After Iftar is commonly convenient."
    }},
    // pain / antiinflammatory
    {key:"paracetamol", ar:"Ø¨Ø§Ø±Ø§Ø³ÙŠØªØ§Ù…ÙˆÙ„", en:"Paracetamol (Acetaminophen)", tags:["paracetamol","acetaminophen","panadol","Ø¨Ù†Ø§Ø¯ÙˆÙ„","Ø¨Ø§Ø±Ø§Ø³ÙŠØªØ§Ù…ÙˆÙ„"], class:"Pain/Fever", advice:{
      ar:"ÙŠÙ…ÙƒÙ† ØªÙ†Ø§ÙˆÙ„Ù‡ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø£Ùˆ Ø§Ù„Ø³Ø­ÙˆØ±. ØªØ¬Ù†Ø¨ ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø¬Ø±Ø¹Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù‚ØµÙˆÙ‰ Ø®ØµÙˆØµÙ‹Ø§ Ù…Ø¹ Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø¨Ø±Ø¯.",
      en:"May be taken as needed after Iftar or Suhoor. Avoid exceeding the daily maximumâ€”watch combination cold/flu products."
    }},
    {key:"ibuprofen", ar:"Ø¥ÙŠØ¨ÙˆØ¨Ø±ÙˆÙÙŠÙ†", en:"Ibuprofen", tags:["ibuprofen","Ø¥ÙŠØ¨ÙˆØ¨Ø±ÙˆÙÙŠÙ†","brufen","Ø¨Ø±ÙˆÙÙŠÙ†"], class:"NSAID", highRisk:true, advice:{
      ar:"âš ï¸ ÙŠÙØ¶Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø£ÙƒÙ„ Ù„ØªÙ‚Ù„ÙŠÙ„ ØªÙ‡ÙŠØ¬ Ø§Ù„Ù…Ø¹Ø¯Ø©. Ù‚Ø¯ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù‰ Ù…Ø¹ Ø§Ù„Ø¬ÙØ§Ùâ€”ÙƒÙ† Ø­Ø°Ø±Ù‹Ø§ ÙˆØ§Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙƒØ§ÙÙŠØ©ØŒ ÙˆØªØ¬Ù†Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ø¥Ø°Ø§ Ù„Ø¯ÙŠÙƒ Ù‚Ø±Ø­Ø©/Ù…Ø±Ø¶ ÙƒÙ„ÙˆÙŠ Ø¥Ù„Ø§ Ø¨ØªÙˆØ¬ÙŠÙ‡ Ø·Ø¨ÙŠ.",
      en:"âš ï¸ Prefer after food to reduce stomach irritation. Can affect kidneys with dehydrationâ€”use cautiously, hydrate well, and avoid if ulcer/CKD unless advised."
    }},
    // thyroid
    {key:"levothyroxine", ar:"Ù„ÙŠÙÙˆØ«ÙŠØ±ÙˆÙƒØ³ÙŠÙ†", en:"Levothyroxine", tags:["levothyroxine","Ù„ÙŠÙÙˆØ«ÙŠØ±ÙˆÙƒØ³ÙŠÙ†","eltroxin","Ø¥Ù„ØªØ±ÙˆÙƒØ³ÙŠÙ†","synthroid"], class:"Thyroid", advice:{
      ar:"ÙŠØ¤Ø®Ø° Ø¹Ù„Ù‰ Ù…Ø¹Ø¯Ø© ÙØ§Ø±ØºØ©. ÙÙŠ Ø±Ù…Ø¶Ø§Ù† Ø®ÙŠØ§Ø±Ø§Ù† Ø´Ø§Ø¦Ø¹Ø§Ù†: (1) Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø­ÙˆØ± Ø¨Ù€ 30â€“60 Ø¯Ù‚ÙŠÙ‚Ø©ØŒ Ø£Ùˆ (2) Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø¨Ù€ 3â€“4 Ø³Ø§Ø¹Ø§Øª (Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø£ÙƒÙ„). Ø§Ù„Ø£Ù‡Ù… Ø§Ù„Ø«Ø¨Ø§Øª Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ø®Ø·Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§.",
      en:"Take on an empty stomach. In Ramadan: either 30â€“60 minutes before Suhoor, or 3â€“4 hours after Iftar (after finishing meals). Consistency is key."
    }},
    // asthma
    {key:"salbutamol", ar:"Ø³Ø§Ù„Ø¨ÙˆØªØ§Ù…ÙˆÙ„", en:"Salbutamol (Albuterol)", tags:["salbutamol","albuterol","ventolin","ÙÙ†ØªÙˆÙ„ÙŠÙ†","Ø³Ø§Ù„Ø¨ÙˆØªØ§Ù…ÙˆÙ„"], class:"Asthma", highRisk:true, advice:{
      ar:"Ø¨Ø®Ø§Ø® Ø§Ù„Ø¥Ø³Ø¹Ø§Ù ÙŠÙØ³ØªØ®Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù„Ù„Ø²ÙˆÙ…. Ø¥Ø°Ø§ Ø²Ø§Ø¯Øª Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØµÙŠØ§Ù…â€”Ù„Ø§ ØªØªØ±Ø¯Ø¯ ÙÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙˆØ§Ø·Ù„Ø¨ ØªÙ‚ÙŠÙŠÙ… Ø·Ø¨ÙŠ. (ØªØ£ÙƒØ¯ Ù…Ù† ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø´Ø±Ø¹ÙŠØ©/Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©).",
      en:"Rescue inhaler as needed. If symptoms worsen during fasting, use it and seek medical review. (Follow local medical/faith guidance)."
    }},
  ];

  const TOP = [
    "Ù…ÙŠØªÙÙˆØ±Ù…ÙŠÙ†","Ø£Ù†Ø³ÙˆÙ„ÙŠÙ†","ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ†","Ø£ÙˆÙ…ÙŠØ¨Ø±Ø§Ø²ÙˆÙ„","Ø¨Ø§Ù†ØªÙˆØ¨Ø±Ø§Ø²ÙˆÙ„","Ø£Ù…Ù„ÙˆØ¯ÙŠØ¨ÙŠÙ†",
    "Ù„ÙˆØ³Ø§Ø±ØªØ§Ù†","Ù„ÙŠØ²ÙŠÙ†ÙˆØ¨Ø±ÙŠÙ„","Ø¨Ø§Ø±Ø§Ø³ÙŠØªØ§Ù…ÙˆÙ„","Ø¥ÙŠØ¨ÙˆØ¨Ø±ÙˆÙÙŠÙ†","Ù„ÙŠÙÙˆØ«ÙŠØ±ÙˆÙƒØ³ÙŠÙ†","Ø£Ù…ÙˆÙƒØ³ÙŠØ³ÙŠÙ„ÙŠÙ†"
  ];

  // ===== Helpers =====
  const norm = (s) => (s||"")
    .toString()
    .trim()
    .toLowerCase()
    .replace(/\s+/g," ")
    .replace(/[Ø£Ø¥Ø¢]/g,"Ø§")
    .replace(/Ø©/g,"Ù‡")
    .replace(/Ù‰/g,"ÙŠ");

  function setLang(next){
    lang = next;
    el.langAR.classList.toggle("active", lang===LANG.AR);
    el.langEN.classList.toggle("active", lang===LANG.EN);
    el.langAR.setAttribute("aria-selected", lang===LANG.AR ? "true":"false");
    el.langEN.setAttribute("aria-selected", lang===LANG.EN ? "true":"false");
    el.hint.textContent = lang===LANG.AR
      ? "Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ (Ù…Ø«Ø§Ù„: ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ†ØŒ Ù…ÙŠØªÙÙˆØ±Ù…ÙŠÙ†ØŒ Ø£ÙˆÙ…ÙŠØ¨Ø±Ø§Ø²ÙˆÙ„) Ø«Ù… Ø§Ø¶ØºØ· Ø¥Ø±Ø³Ø§Ù„."
      : "Type a medication name (e.g., warfarin, metformin, omeprazole) then press Send.";
    el.input.placeholder = lang===LANG.AR ? "Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ Ù‡Ù†Ø§..." : "Type the medication name...";
    el.send.textContent = lang===LANG.AR ? "Ø¥Ø±Ø³Ø§Ù„" : "Send";
  }

  function bubble(text, who="bot", footer=""){
    const div = document.createElement("div");
    div.className = `bubble ${who}`;
    div.innerHTML = text + (footer ? `<small>${footer}</small>`:"");
    el.chat.appendChild(div);
    el.chat.scrollTop = el.chat.scrollHeight;
  }

  function findDrug(q){
    const nq = norm(q);
    if(!nq) return [];
    return DB.filter(d => d.tags.some(t => nq.includes(norm(t))));
  }

  function replyFor(drug){
    const disclaimerAR = "ØªÙ†Ø¨ÙŠÙ‡: Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ«Ù‚ÙŠÙ ÙˆÙ„ÙŠØ³Øª Ø¨Ø¯ÙŠÙ„Ù‹Ø§ Ø¹Ù† Ø§Ù„Ø·Ø¨ÙŠØ¨/Ø§Ù„ØµÙŠØ¯Ù„ÙŠ. Ø¥Ø°Ø§ Ù„Ø¯ÙŠÙƒ Ø³ÙƒØ±ÙŠ Ø¹Ù„Ù‰ Ø£Ù†Ø³ÙˆÙ„ÙŠÙ†ØŒ Ø£Ùˆ Ø£Ø¯ÙˆÙŠØ© Ø³ÙŠÙˆÙ„Ø©ØŒ Ø£Ùˆ Ù…Ø±Ø¶ ÙƒÙ„Ù‰/Ù‚Ù„Ø¨â€”Ø§Ø³ØªØ´Ø± Ø·Ø¨ÙŠØ¨Ùƒ Ù‚Ø¨Ù„ Ø£ÙŠ ØªØ¹Ø¯ÙŠÙ„.";
    const disclaimerEN = "Note: General education onlyâ€”not a substitute for your clinician/pharmacist. If you use insulin, anticoagulants, or have kidney/heart disease, consult your care team before any changes.";
    const title = lang===LANG.AR ? drug.ar : drug.en;
    const cls = lang===LANG.AR ? "Ø§Ù„ØªØµÙ†ÙŠÙ" : "Class";
    const risk = drug.highRisk ? (lang===LANG.AR ? "âš ï¸ ÙŠØ­ØªØ§Ø¬ Ø­Ø°Ø±/Ø®Ø·Ø© ÙØ±Ø¯ÙŠØ©" : "âš ï¸ Higher-risk / individualized plan") : "";
    const advice = lang===LANG.AR ? drug.advice.ar : drug.advice.en;
    const disc = lang===LANG.AR ? disclaimerAR : disclaimerEN;

    const html = `<b>${title}</b><br><span style="opacity:.85">${cls}: ${drug.class}${risk ? " â€¢ "+risk : ""}</span><br><br>${advice}`;
    return { html, disc };
  }

  function clearChat(){
    el.chat.innerHTML = "";
    welcome();
  }

  function welcome(){
    const w = lang===LANG.AR
      ? "Ù…Ø±Ø­Ø¨Ù‹Ø§ ğŸ‘‹ Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ø°ÙƒÙŠ. Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ ÙˆØ³Ø£Ø¹Ø·ÙŠÙƒ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© Ù„ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø¬Ø±Ø¹Ø© ÙÙŠ Ø±Ù…Ø¶Ø§Ù†."
      : "Hi ğŸ‘‹ Iâ€™m the Ramadan Smart Assistant. Type a medication name and Iâ€™ll provide general Ramadan timing guidance.";
    bubble(w, "bot");
  }

  function handleSend(text){
    const raw = (text ?? el.input.value).trim();
    if(!raw) return;
    bubble(lang===LANG.AR ? `<b>Ø£Ù†Øª:</b> ${raw}` : `<b>You:</b> ${raw}`, "user");
    el.input.value = "";

    const hits = findDrug(raw);
    if(hits.length){
      // If multiple matches, show first 2
      hits.slice(0,2).forEach(d => {
        const r = replyFor(d);
        bubble(r.html, "bot", r.disc);
      });
    }else{
      const msg = lang===LANG.AR
        ? "Ù„Ù… Ø£ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙˆØ§Ø¡. Ø¬Ø±Ù‘Ø¨ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ù„Ù…ÙŠ/Ø§Ù„ØªØ¬Ø§Ø±ÙŠØŒ Ø£Ùˆ Ø§ÙƒØªØ¨ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø§Ø³Ù…."
        : "I couldnâ€™t match that medication. Try the generic/brand name, or part of the name.";
      bubble(msg, "bot");
    }
  }

  // ===== Events =====
  el.send.addEventListener("click", () => handleSend());
  el.input.addEventListener("keydown", (e) => {
    if(e.key === "Enter"){ e.preventDefault(); handleSend(); }
  });

  el.langAR.addEventListener("click", () => { setLang(LANG.AR); clearChat(); });
  el.langEN.addEventListener("click", () => { setLang(LANG.EN); clearChat(); });

  el.btnClear.addEventListener("click", clearChat);

  el.btnExamples.addEventListener("click", () => {
    const examples = lang===LANG.AR
      ? ["ÙˆØ§Ø±ÙØ§Ø±ÙŠÙ†","Ù…ÙŠØªÙÙˆØ±Ù…ÙŠÙ†","Ø£ÙˆÙ…ÙŠØ¨Ø±Ø§Ø²ÙˆÙ„","Ù„ÙŠÙÙˆØ«ÙŠØ±ÙˆÙƒØ³ÙŠÙ†","Ø£Ù…Ù„ÙˆØ¯ÙŠØ¨ÙŠÙ†"]
      : ["warfarin","metformin","omeprazole","levothyroxine","amlodipine"];
    bubble((lang===LANG.AR ? "Ø£Ù…Ø«Ù„Ø©:" : "Examples:") + " " + examples.join(" â€¢ "), "bot");
  });

  el.btnTop.addEventListener("click", () => {
    const list = (lang===LANG.AR ? TOP : TOP.map(x => x)); // AR list is fine; users can type EN too
    bubble((lang===LANG.AR ? "Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ù‹Ø§ (Ø§Ø¶ØºØ·/Ø§Ù†Ø³Ø® Ø§Ù„Ø§Ø³Ù…):" : "Top common (type/copy the name):") + "<br><br>" +
      list.map(n => `â€¢ ${n}`).join("<br>"), "bot");
  });

  // ===== Init =====
  setLang(LANG.AR);
  clearChat();
})();
</script>

</body>
</html>
