<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QCH â€“ Smart Ramadan Medication Assistant</title>

<link rel="manifest" href="manifest.webmanifest">

<style>
:root{
  --primary:#2aa6ff;
  --accent:#35d0c7;
  --bg:#f4f9fc;
  --card:#ffffff;
  --border:#dbe7ef;
  --text:#0b2230;
  --muted:#6b8796;
  --radius:20px;
  --shadow:0 15px 40px rgba(0,0,0,.08);
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:var(--bg);
  color:var(--text);
}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:20px 30px;
  background:var(--card);
  border-bottom:1px solid var(--border);
  box-shadow:var(--shadow);
}

.logo{
  height:75px;
}

.title{
  text-align:center;
  flex:1;
}

.title h1{
  margin:0;
  font-size:22px;
}

.title p{
  margin:4px 0 0;
  color:var(--muted);
  font-size:14px;
}

.container{
  display:grid;
  grid-template-columns:300px 1fr;
  gap:25px;
  padding:25px;
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:20px;
  box-shadow:var(--shadow);
}

.sidebar h3{
  margin-top:0;
}

.btn{
  display:inline-block;
  padding:10px 14px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#fff;
  cursor:pointer;
  margin:6px 4px;
  font-size:14px;
}

.btn.primary{
  background:var(--accent);
  color:#fff;
  border:none;
}

.btn.danger{
  background:#ff4d4f;
  color:#fff;
  border:none;
}

.chat{
  min-height:300px;
  margin-bottom:20px;
}

.bubble{
  background:#f0f7fb;
  padding:15px;
  border-radius:15px;
  margin-bottom:15px;
  border:1px solid var(--border);
}

input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid var(--border);
}

.footer{
  text-align:center;
  padding:20px;
  font-size:13px;
  color:var(--muted);
}

.kpi{
  background:#f6fbff;
  padding:15px;
  border-radius:15px;
  border:1px solid var(--border);
  margin-bottom:15px;
}

</style>
</head>

<body>

<header>
  <img src="logo_qch.png" class="logo">
  <div class="title">
    <h1>QCH â€“ Ù…Ø³Ø§Ø¹Ø¯ Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ø£Ø¯ÙˆÙŠØ©</h1>
    <p>Arabic â€¢ English â€¢ Patient Friendly â€¢ Offline Analytics</p>
  </div>
  <img src="logo_health_holding.png" class="logo">
</header>

<div class="container">

  <div class="card sidebar">
    <h3>Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</h3>
    <button class="btn" onclick="filterCategory('Hypertension')">Ø¶ØºØ· â¤ï¸</button>
    <button class="btn" onclick="filterCategory('Diabetes')">Ø³ÙƒØ± ğŸ©¸</button>
    <button class="btn" onclick="filterCategory('Thyroid')">Ø§Ù„ØºØ¯Ø© ğŸ¦‹</button>
    <button class="btn" onclick="filterCategory('GI')">Ø§Ù„Ù…Ø¹Ø¯Ø© ğŸ½</button>

    <hr>

    <div class="kpi">
      <strong id="drugsLoaded">0</strong><br>
      Drugs loaded
    </div>

    <div class="kpi">
      <strong id="tracked">0</strong><br>
      Tracked selections
    </div>

    <button class="btn danger" onclick="clearChat()">Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ğŸ—‘</button>
  </div>

  <div class="card">
    <div class="chat" id="chat"></div>

    <input id="input" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ Ù‡Ù†Ø§..." onkeypress="handleKey(event)">
    <br><br>
    <button class="btn primary" onclick="searchDrug()">Ø¥Ø±Ø³Ø§Ù„</button>
  </div>

</div>

<div class="footer">
Created by Automation Supervisor Ali Alsada
</div>

<script>
let DRUGS=[];
let tracked=0;

async function loadDrugs(){
  try{
    const res=await fetch("drugs.json");
    DRUGS=await res.json();
    document.getElementById("drugsLoaded").innerText=DRUGS.length;
  }catch{
    console.log("Failed loading drugs.json");
  }
}
loadDrugs();

function searchDrug(){
  const val=document.getElementById("input").value.toLowerCase();
  const drug=DRUGS.find(d=>d.name.toLowerCase().includes(val));
  if(drug){
    addMessage(`<strong>${drug.name}</strong><br>${drug.ramadan_ar}`);
    tracked++;
    document.getElementById("tracked").innerText=tracked;
  }else{
    addMessage("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¯ÙˆØ§Ø¡ Ù…Ø·Ø§Ø¨Ù‚.");
  }
}

function filterCategory(cat){
  const results=DRUGS.filter(d=>d.category===cat);
  if(results.length===0){
    addMessage("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ.");
  }else{
    results.forEach(d=>addMessage(`<strong>${d.name}</strong><br>${d.ramadan_ar}`));
  }
}

function addMessage(msg){
  const div=document.createElement("div");
  div.className="bubble";
  div.innerHTML=msg;
  document.getElementById("chat").appendChild(div);
}

function clearChat(){
  document.getElementById("chat").innerHTML="";
}

function handleKey(e){
  if(e.key==="Enter") searchDrug();
}
</script>

</body>
</html>
