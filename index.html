<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>QCH â€“ Ramadan Medication Assistant</title>

<style>
  :root{
    --brand:#0aa6a6;
    --brand2:#1e88e5;
    --bg:#f4fbfb;
    --ink:#0b1b2b;
    --muted:#5b6b7a;
    --line:#e6edf2;
    --shadow:0 12px 28px rgba(0,0,0,.08);
    --r:22px;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
  }
  body{
    margin:0;
    background:
      radial-gradient(1100px 600px at 15% 0%, rgba(10,166,166,.16), transparent 55%),
      radial-gradient(1100px 600px at 90% 10%, rgba(30,136,229,.16), transparent 55%),
      linear-gradient(135deg,#eef9f9,#eef4fb);
    color:var(--ink);
  }
  .wrap{max-width:1000px;margin:0 auto;padding:12px;display:flex;flex-direction:column;gap:12px;}

  header{
    background:rgba(255,255,255,.90);
    border:1px solid var(--line);
    border-radius:var(--r);
    box-shadow:var(--shadow);
    padding:14px;
    display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
  }
  .brandSide{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
  .logoRow{display:flex;align-items:center;gap:10px}
  .brandText{font-size:12px;line-height:1.2}
  .brandText b{font-size:12.5px}
  .title{text-align:center;flex:1;min-width:240px}
  .title h1{margin:0;font-size:18px;font-weight:1000;color:#0a2540}
  .title p{margin:4px 0 0;font-size:13px;color:var(--muted)}
  .controls{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
  .btn{
    border:1px solid var(--line);
    background:#fff;
    border-radius:999px;
    padding:10px 12px;
    font-weight:1000;
    cursor:pointer;
    box-shadow:0 10px 18px rgba(0,0,0,.05);
    user-select:none;
  }
  .btn.active{background:linear-gradient(135deg, rgba(10,166,166,.20), rgba(30,136,229,.12));}
  .btn.warn{border-color:rgba(180,83,9,.20);background:rgba(180,83,9,.06);}

  .card{
    background:rgba(255,255,255,.90);
    border:1px solid var(--line);
    border-radius:var(--r);
    box-shadow:var(--shadow);
    overflow:hidden;
  }
  .topbar{
    padding:12px 14px;
    border-bottom:1px solid var(--line);
    display:flex;gap:10px;align-items:center;flex-wrap:wrap;
  }
  .pill{
    display:inline-flex;align-items:center;gap:8px;
    padding:7px 10px;border-radius:999px;
    background:rgba(10,166,166,.10);border:1px solid rgba(10,166,166,.18);
    color:#055;font-weight:1000;font-size:12px;
  }
  .hint{color:var(--muted);font-size:13px;line-height:1.5;flex:1}

  .grid{
    padding:12px 14px;
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
  }
  .tile{
    border:1px solid rgba(10,166,166,.18);
    background:#fff;
    border-radius:18px;
    padding:14px 12px;
    cursor:pointer;
    box-shadow:0 10px 18px rgba(0,0,0,.05);
    user-select:none;
    transition:transform .06s ease;
    min-height:78px;
    display:flex;align-items:center;justify-content:space-between;gap:10px;
    font-weight:1000;
  }
  .tile:hover{transform:translateY(-1px);}
  .tile small{display:block;font-weight:800;color:var(--muted);font-size:12px;margin-top:4px}

  .searchRow{
    padding:10px 14px;
    border-top:1px solid var(--line);
    display:flex;
    gap:10px;
    align-items:center;
    background:rgba(255,255,255,.92);
  }
  .searchRow input{
    flex:1;
    padding:12px 14px;
    border-radius:999px;
    border:1px solid var(--line);
    outline:none;
    font-size:16px;
    background:#fff;
  }
  .searchRow input:focus{border-color:rgba(10,166,166,.45);box-shadow:0 0 0 4px rgba(10,166,166,.10)}
  .searchRow button{
    padding:12px 14px;
    border-radius:999px;
    border:1px solid rgba(10,166,166,.25);
    background:linear-gradient(135deg, rgba(10,166,166,.20), rgba(30,136,229,.12));
    font-weight:1000;
    cursor:pointer;
  }

  .chat{
    border-top:1px solid var(--line);
    background:rgba(255,255,255,.78);
  }
  .msgs{padding:12px 14px;height:42vh;min-height:360px;overflow:auto}
  .msg{
    background:#fff;border:1px solid var(--line);border-radius:16px;padding:10px 10px;margin:8px 0;
    box-shadow:0 10px 18px rgba(0,0,0,.04);white-space:pre-wrap;line-height:1.55;font-size:15px
  }
  .msg.user{background:rgba(30,136,229,.06);border-color:rgba(30,136,229,.16)}
  .note{
    padding:10px 14px 14px;
    color:var(--muted);
    font-size:12px;
    line-height:1.45;
    border-top:1px dashed var(--line);
  }

  .qrBox{
    margin-top:12px;
    background:rgba(255,255,255,.90);
    border:1px solid var(--line);
    border-radius:18px;
    box-shadow:0 10px 18px rgba(0,0,0,.05);
    padding:12px 14px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    flex-wrap:wrap;
  }
  .qrBox .qrText{flex:1;min-width:220px}
  .qrBox h3{margin:0;font-size:14px}
  .qrBox p{margin:6px 0 0;color:var(--muted);font-size:12.5px;line-height:1.45}
  .qrBox img{width:150px;height:150px;border-radius:14px;border:1px solid var(--line);background:#fff}

  footer{
    margin-top:12px;
    text-align:center;
    font-size:12px;
    color:var(--muted);
    background:rgba(255,255,255,.90);
    border:1px solid var(--line);
    border-radius:18px;
    padding:12px 14px;
    box-shadow:0 10px 18px rgba(0,0,0,.05);
  }

  .rtl{direction:rtl;text-align:right}
  .ltr{direction:ltr;text-align:left}
  @media(max-width:900px){ .grid{grid-template-columns:repeat(2,1fr)} }
  @media(max-width:560px){ .grid{grid-template-columns:1fr} .title{text-align:right} }
</style>
</head>

<body>
<div class="wrap">

  <header>
    <!-- Left/QCH -->
    <div class="brandSide">
      <div class="logoRow">
        <!-- QCH SVG (embedded) -->
        <svg width="52" height="52" viewBox="0 0 64 64" aria-label="QCH Logo">
          <defs>
            <linearGradient id="qchG" x1="0" x2="1">
              <stop offset="0" stop-color="#0aa6a6"/>
              <stop offset="1" stop-color="#35d0c7"/>
            </linearGradient>
          </defs>
          <circle cx="32" cy="32" r="30" fill="url(#qchG)"/>
          <path d="M20 28h24v18H20z" fill="rgba(255,255,255,.22)"/>
          <path d="M24 24h16v6H24z" fill="rgba(255,255,255,.22)"/>
          <text x="32" y="38" font-size="14" fill="#fff" text-anchor="middle" font-weight="900">QCH</text>
        </svg>
        <div class="brandText">
          <b>Qatif Central Hospital</b><br>Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù‚Ø·ÙŠÙ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ
        </div>
      </div>
    </div>

    <!-- Center title -->
    <div class="title">
      <h1 id="appTitle">Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ÙÙŠ Ø±Ù…Ø¶Ø§Ù†</h1>
      <p id="appSub">Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰ â€¢ Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø§Ù„Ø£Ø²Ø±Ø§Ø± + Ø¨Ø­Ø« Ø§Ø®ØªÙŠØ§Ø±ÙŠ</p>
    </div>

    <!-- Right/EHC -->
    <div class="brandSide">
      <div class="logoRow">
        <!-- EHC SVG (embedded) -->
        <svg width="52" height="52" viewBox="0 0 64 64" aria-label="EHC Logo">
          <defs>
            <linearGradient id="ehcG" x1="0" x2="1">
              <stop offset="0" stop-color="#1e88e5"/>
              <stop offset="1" stop-color="#42a5f5"/>
            </linearGradient>
          </defs>
          <circle cx="32" cy="32" r="30" fill="url(#ehcG)"/>
          <path d="M22 22h20v20H22z" fill="rgba(255,255,255,.18)"/>
          <text x="32" y="38" font-size="14" fill="#fff" text-anchor="middle" font-weight="900">EHC</text>
        </svg>
        <div class="brandText">
          <b>Eastern Health Cluster</b><br>Ø§Ù„ØªØ¬Ù…Ø¹ Ø§Ù„ØµØ­ÙŠ Ø§Ù„Ø´Ø±Ù‚ÙŠ
        </div>
      </div>
    </div>

    <!-- Controls -->
    <div class="controls">
      <button class="btn active" id="arBtn">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
      <button class="btn" id="enBtn">English</button>
      <button class="btn" id="homeBtn">ğŸ  Ø§Ù„ÙØ¦Ø§Øª</button>
      <button class="btn warn" id="resetBtn">ğŸ§¹ ØªÙ†Ø¸ÙŠÙ</button>
    </div>
  </header>

  <div class="card">
    <div class="topbar">
      <span class="pill" id="modePill">Patients â€¢ Buttons-Only</span>
      <div class="hint" id="hintText">Ø§Ø®ØªØ± ÙØ¦Ø© Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ§Ø¡. Ø£Ùˆ Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«.</div>
    </div>

    <div class="grid" id="grid"></div>

    <!-- Search (always available) -->
    <div class="searchRow">
      <input id="searchInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡â€¦ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
      <button id="searchBtn">Ø¨Ø­Ø«</button>
    </div>

    <div class="chat">
      <div class="msgs" id="msgs"></div>
      <div class="note" id="note">
        Ø£Ù…Ø§Ù†: Ù‡Ø¨ÙˆØ· Ø³ÙƒØ± Ø´Ø¯ÙŠØ¯ØŒ Ø£Ù„Ù… ØµØ¯Ø±ØŒ Ø¶ÙŠÙ‚ Ù†ÙØ³ Ø´Ø¯ÙŠØ¯ØŒ Ø£Ùˆ Ù†Ø²ÙŠÙ Ù‚ÙˆÙŠ â†’ Ø§ÙØ·Ø± ÙÙˆØ±Ù‹Ø§ ÙˆØ±Ø§Ø¬Ø¹ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦.
      </div>
    </div>
  </div>

  <!-- QR (opens your chatbot link) -->
  <div class="qrBox">
    <div class="qrText">
      <h3 id="qrTitle">QR Ù„ÙØªØ­ Ø§Ù„Ø´Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©</h3>
      <p id="qrDesc">Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„ÙØªØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ø´Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„.</p>
      <p style="margin-top:6px;color:#0a2540;font-weight:900" id="qrLinkText"></p>
    </div>
    <img id="qrImg" alt="QR code" />
  </div>

  <footer>
    Created by Automation Supervisor <b>Ali Alsada</b><br>
    Qatif Central Hospital â€“ Eastern Health Cluster
  </footer>

</div>

<script>
/* =======================
   State + Helpers
======================= */
const state = { lang:"ar", view:"cats", currentCat:null };
const grid = document.getElementById("grid");
const msgs = document.getElementById("msgs");
const hintText = document.getElementById("hintText");
const note = document.getElementById("note");
const appTitle = document.getElementById("appTitle");
const appSub = document.getElementById("appSub");
const searchInput = document.getElementById("searchInput");
const qrTitle = document.getElementById("qrTitle");
const qrDesc = document.getElementById("qrDesc");
const qrImg = document.getElementById("qrImg");
const qrLinkText = document.getElementById("qrLinkText");

function add(role, text){
  const d = document.createElement("div");
  d.className = "msg " + (role==="user" ? "user" : "bot");
  d.classList.add(state.lang==="ar" ? "rtl" : "ltr");
  d.textContent = text;
  msgs.appendChild(d);
  msgs.scrollTop = msgs.scrollHeight;
}

function resetChat(){
  msgs.innerHTML = "";
  add("bot", state.lang==="ar"
    ? "Ù…Ø±Ø­Ø¨Ù‹Ø§ ğŸ‘‹ Ø§Ø®ØªØ± ÙØ¦Ø© Ù…Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø±."
    : "Hello ğŸ‘‹ Choose a category below."
  );
}

function setLang(lang){
  state.lang = lang;
  document.getElementById("arBtn").classList.toggle("active", lang==="ar");
  document.getElementById("enBtn").classList.toggle("active", lang==="en");
  document.documentElement.dir = (lang==="ar") ? "rtl" : "ltr";
  document.documentElement.lang = (lang==="ar") ? "ar" : "en";

  if(lang==="ar"){
    appTitle.textContent = "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ÙÙŠ Ø±Ù…Ø¶Ø§Ù†";
    appSub.textContent = "Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰ â€¢ Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø§Ù„Ø£Ø²Ø±Ø§Ø± + Ø¨Ø­Ø« Ø§Ø®ØªÙŠØ§Ø±ÙŠ";
    hintText.textContent = (state.view==="cats")
      ? "Ø§Ø®ØªØ± ÙØ¦Ø© Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ§Ø¡. Ø£Ùˆ Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«."
      : "Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ§Ø¡ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©. Ø§Ø¶ØºØ· (ğŸ  Ø§Ù„ÙØ¦Ø§Øª) Ù„Ù„Ø±Ø¬ÙˆØ¹.";
    note.textContent = "Ø£Ù…Ø§Ù†: Ù‡Ø¨ÙˆØ· Ø³ÙƒØ± Ø´Ø¯ÙŠØ¯ØŒ Ø£Ù„Ù… ØµØ¯Ø±ØŒ Ø¶ÙŠÙ‚ Ù†ÙØ³ Ø´Ø¯ÙŠØ¯ØŒ Ø£Ùˆ Ù†Ø²ÙŠÙ Ù‚ÙˆÙŠ â†’ Ø§ÙØ·Ø± ÙÙˆØ±Ù‹Ø§ ÙˆØ±Ø§Ø¬Ø¹ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦.";
    searchInput.placeholder = "Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡â€¦ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)";
    qrTitle.textContent = "QR Ù„ÙØªØ­ Ø§Ù„Ø´Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©";
    qrDesc.textContent = "Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„ÙØªØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ø´Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„.";
  }else{
    appTitle.textContent = "Ramadan Medication Assistant";
    appSub.textContent = "Patients version â€¢ Buttons + optional search";
    hintText.textContent = (state.view==="cats")
      ? "Choose a category, then tap a medicine. Or search by name."
      : "Tap a medicine. Use (ğŸ  Categories) to go back.";
    note.textContent = "Safety: Severe low sugar, chest pain, severe shortness of breath, or heavy bleeding â†’ break the fast and seek urgent care.";
    searchInput.placeholder = "Type medicine nameâ€¦ (optional)";
    qrTitle.textContent = "QR to open the chatbot";
    qrDesc.textContent = "Scan with your camera to open the link on mobile.";
  }
  render();
}

function normalize(s){
  return (s||"").toLowerCase().replace(/\s+/g," ").trim();
}

/* =======================
   Categories
======================= */
const CATS = [
  {key:"diabetes", icon:"ğŸ¬", ar:"Ø§Ù„Ø³ÙƒØ±ÙŠ", en:"Diabetes"},
  {key:"bp", icon:"ğŸ«€", ar:"Ø§Ù„Ø¶ØºØ·/Ø§Ù„Ù‚Ù„Ø¨", en:"BP / Heart"},
  {key:"blood", icon:"ğŸ©¸", ar:"Ù…Ù…ÙŠØ¹Ø§Øª/Ø³ÙŠÙˆÙ„Ø© Ø§Ù„Ø¯Ù…", en:"Blood thinners"},
  {key:"gi", icon:"ğŸ§¡", ar:"Ø§Ù„Ù…Ø¹Ø¯Ø©/Ø§Ù„Ø­Ù…ÙˆØ¶Ø©", en:"Stomach/GERD"},
  {key:"abx", icon:"ğŸ¦ ", ar:"Ù…Ø¶Ø§Ø¯Ø§Øª Ø­ÙŠÙˆÙŠØ©", en:"Antibiotics"},
  {key:"resp", icon:"ğŸ«", ar:"Ø§Ù„Ø±Ø¨Ùˆ/Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©", en:"Asthma/Allergy"},
  {key:"pain", icon:"ğŸ’Š", ar:"Ù…Ø³ÙƒÙ†Ø§Øª/Ø§Ù„ØªÙ‡Ø§Ø¨", en:"Pain/Inflammation"},
  {key:"thyroid", icon:"ğŸ¦‹", ar:"Ø§Ù„ØºØ¯Ø©/Ù‡Ø±Ù…ÙˆÙ†Ø§Øª", en:"Thyroid/Hormones"},
  {key:"rheum", icon:"ğŸ¦´", ar:"Ø§Ù„Ø±ÙˆÙ…Ø§ØªÙŠØ²Ù…/Ù…Ù†Ø§Ø¹Ø©", en:"Rheumatology/Immune"},
  {key:"neuro", icon:"ğŸ§ ", ar:"Ø£Ø¹ØµØ§Ø¨/Ù†ÙØ³ÙŠØ©", en:"Neuro/Psych"},
  {key:"supp", icon:"ğŸ§²", ar:"Ù…ÙƒÙ…Ù„Ø§Øª", en:"Supplements"},
  {key:"other", icon:"ğŸ“Œ", ar:"Ø£Ø¯ÙˆÙŠØ© Ù…ØªÙ†ÙˆØ¹Ø©", en:"Other"}
];

/* =======================
   Patient templates (safe, simple)
======================= */
const TEMPLATES = {
  insulin: {
    ar:`ğŸ’‰ Ø§Ù„Ø¥Ù†Ø³ÙˆÙ„ÙŠÙ† (Ù…Ù‡Ù… Ø¬Ø¯Ù‹Ø§)
â€¢ Ù„Ø§ ØªØºÙŠÙ‘Ø± Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ø¨Ù†ÙØ³Ùƒ.
â€¢ Ø¥Ø°Ø§ Ø³ÙƒØ± <70 Ø£Ùˆ Ø£Ø¹Ø±Ø§Ø¶ Ù‡Ø¨ÙˆØ· Ø´Ø¯ÙŠØ¯Ø© â†’ Ø§ÙØ·Ø± ÙÙˆØ±Ù‹Ø§ ÙˆØ¹Ø§Ù„Ø¬ Ø§Ù„Ù‡Ø¨ÙˆØ·.
â€¢ ØºØ§Ù„Ø¨Ù‹Ø§: Ø§Ù„Ø¥Ù†Ø³ÙˆÙ„ÙŠÙ† Ø§Ù„Ø·ÙˆÙŠÙ„/Ø§Ù„Ù‚Ø§Ø¹Ø¯ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± (Ø­Ø³Ø¨ Ø®Ø·Ø© Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©).
â€¢ Ø§Ù„Ø¥Ù†Ø³ÙˆÙ„ÙŠÙ† Ø§Ù„Ø³Ø±ÙŠØ¹ Ù…Ø¹ Ø§Ù„ÙˆØ¬Ø¨Ø© (ÙˆÙ‚Ø¯ ØªÙ‚Ù„ Ø¬Ø±Ø¹Ø© Ø§Ù„Ø³Ø­ÙˆØ±).`,
    en:`ğŸ’‰ Insulin (very important)
â€¢ Do NOT change doses yourself.
â€¢ If glucose <70 or severe symptoms â†’ BREAK FAST and treat.
â€¢ Basal is often after Iftar (per clinic plan).
â€¢ Rapid insulin is taken with meals (Suhoor dose may be lower).`
  },
  diabetes_oral:{
    ar:`ğŸ¬ Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø³ÙƒØ± (Ø­Ø¨ÙˆØ¨)
â€¢ ØºØ§Ù„Ø¨Ù‹Ø§ ØªØ¤Ø®Ø° Ù…Ø¹ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ùˆ/Ø£Ùˆ Ø§Ù„Ø³Ø­ÙˆØ± Ø­Ø³Ø¨ Ø§Ù„ÙˆØµÙØ©.
â€¢ Ø¥Ø°Ø§ Ø¯ÙˆØ§Ø¡ ÙŠØ³Ø¨Ø¨ Ù‡Ø¨ÙˆØ· â†’ Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù‡Ø¨ÙˆØ·.`,
    en:`ğŸ¬ Diabetes pills
â€¢ Usually with Iftar and/or Suhoor per prescription.
â€¢ If a medicine can cause lows â†’ watch hypoglycemia.`
  },
  bp_once:{
    ar:`ğŸ«€ Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø¶ØºØ·/Ø§Ù„Ù‚Ù„Ø¨ (Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§)
â€¢ Ø§Ù„Ø£ÙØ¶Ù„ ÙˆÙ‚Øª Ø«Ø§Ø¨Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±.
â€¢ Ø¥Ø°Ø§ Ø¯ÙˆØ®Ø© Ø´Ø¯ÙŠØ¯Ø© Ø£Ùˆ Ø¥ØºÙ…Ø§Ø¡ â†’ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨.`,
    en:`ğŸ«€ BP/Heart medicines (once daily)
â€¢ Best at a fixed time after Iftar.
â€¢ Severe dizziness/fainting â†’ contact clinician.`
  },
  diuretic:{
    ar:`ğŸ’§ Ù…Ø¯Ø±Ø§Øª Ø§Ù„Ø¨ÙˆÙ„
â€¢ Ø§Ù„Ø£ÙØ¶Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±/Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù„ÙŠÙ„ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø¹Ø·Ø´ ÙˆÙƒØ«Ø±Ø© Ø§Ù„ØªØ¨ÙˆÙ„ ÙˆÙ‚Øª Ø§Ù„Ø³Ø­ÙˆØ±.`,
    en:`ğŸ’§ Diuretics (water pills)
â€¢ Prefer after Iftar/early evening to reduce thirst and nighttime urination.`
  },
  anticoagulant:{
    ar:`ğŸ©¸ Ù…Ù…ÙŠØ¹Ø§Øª Ø§Ù„Ø¯Ù…
â€¢ ÙˆÙ‚Øª Ø«Ø§Ø¨Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§.
â€¢ Ø¥Ø°Ø§ Ù…Ø±ØªÙŠÙ† ÙŠÙˆÙ…ÙŠÙ‹Ø§: Ø¥ÙØ·Ø§Ø± + Ø³Ø­ÙˆØ±.
â€¢ Ù†Ø²ÙŠÙ Ø´Ø¯ÙŠØ¯/Ø¨Ø±Ø§Ø² Ø£Ø³ÙˆØ¯/Ù‚ÙŠØ¡ Ø¯Ù… â†’ Ø·ÙˆØ§Ø±Ø¦.`,
    en:`ğŸ©¸ Blood thinners
â€¢ Fixed time daily.
â€¢ If BID: Iftar + Suhoor.
â€¢ Heavy bleeding/black stool/vomiting blood â†’ ER.`
  },
  antiplatelet:{
    ar:`ğŸ«€ Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„ØµÙØ§Ø¦Ø­ (Ø£Ø³Ø¨Ø±ÙŠÙ†/ÙƒÙ„ÙˆØ¨ÙŠØ¯ÙˆØ¬Ø±ÙŠÙ„)
â€¢ ØºØ§Ù„Ø¨Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù…Ø¹ Ø§Ù„Ø£ÙƒÙ„ (Ø£Ù„Ø·Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø¯Ø©).
â€¢ Ù„Ø§ ØªÙˆÙ‚ÙÙ‡ Ø¨Ø¯ÙˆÙ† Ø§Ù„Ø·Ø¨ÙŠØ¨.`,
    en:`ğŸ«€ Antiplatelets (aspirin/clopidogrel)
â€¢ Often after Iftar with food (gentler on stomach).
â€¢ Do not stop without clinician.`
  },
  ppi:{
    ar:`ğŸ§¡ Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø­Ù…ÙˆØ¶Ø© (PPI)
â€¢ Ø§Ù„Ø£ÙØ¶Ù„: Ù‚Ø¨Ù„ Ø§Ù„Ø£ÙƒÙ„ Ø¨Ù€ 30â€“60 Ø¯Ù‚ÙŠÙ‚Ø©.
â€¢ Ù…Ø±Ø©: Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø­ÙˆØ± Ø£Ùˆ Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø±.
â€¢ Ù…Ø±ØªÙŠÙ†: Ù‚Ø¨Ù„ Ø§Ù„Ø¥ÙØ·Ø§Ø± + Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø­ÙˆØ±.`,
    en:`ğŸ§¡ PPIs (omeprazole/pantoprazole)
â€¢ Best: 30â€“60 minutes BEFORE meals.
â€¢ OD: before Suhoor or Iftar.
â€¢ BID: before Iftar + before Suhoor.`
  },
  antibiotic:{
    ar:`ğŸ¦  Ø§Ù„Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„Ø­ÙŠÙˆÙŠØ© (Ø¹Ø§Ù…)
â€¢ Ù…Ø±ØªÙŠÙ†: Ø¥ÙØ·Ø§Ø± + Ø³Ø­ÙˆØ±.
â€¢ Ø«Ù„Ø§Ø« Ù…Ø±Ø§Øª: Ø¥ÙØ·Ø§Ø± + Ø¢Ø®Ø± Ø§Ù„Ù„ÙŠÙ„ + Ø³Ø­ÙˆØ±.
â€¢ Ø£ÙƒÙ…Ù„ Ù…Ø¯Ø© Ø§Ù„Ù…Ø¶Ø§Ø¯.`,
    en:`ğŸ¦  Antibiotics (general)
â€¢ BID: Iftar + Suhoor.
â€¢ TID: Iftar + late evening + Suhoor.
â€¢ Finish the full course.`
  },
  asthma:{
    ar:`ğŸ« Ø§Ù„Ø±Ø¨Ùˆ/Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©
â€¢ Ø§Ø³ØªÙ…Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø®Ø§Ø®Ø§Øª Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙˆØµÙØ©.
â€¢ Ø¨Ø®Ø§Ø® Ø§Ù„Ø¥Ø³Ø¹Ø§Ù Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø© ÙˆÙ„Ø§ ØªØ¤Ø®Ø±Ù‡ Ø¥Ø°Ø§ Ø¶ÙŠÙ‚ Ù†ÙØ³.`,
    en:`ğŸ« Asthma/Allergy
â€¢ Continue controller inhalers as prescribed.
â€¢ Use rescue inhaler as neededâ€”donâ€™t delay with breathing trouble.`
  },
  pain:{
    ar:`ğŸ’Š Ù…Ø³ÙƒÙ†Ø§Øª/Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ‡Ø§Ø¨
â€¢ Ø§Ù„Ø£ÙØ¶Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù…Ø¹ Ø§Ù„Ø£ÙƒÙ„ Ù„ØªÙ‚Ù„ÙŠÙ„ ØªÙ‡ÙŠØ¬ Ø§Ù„Ù…Ø¹Ø¯Ø©.
â€¢ Ø¥Ø°Ø§ Ù„Ø¯ÙŠÙƒ Ù‚Ø±Ø­Ø©/Ù…Ø´Ø§ÙƒÙ„ ÙƒÙ„Ù‰/Ù†Ø²ÙŠÙ â†’ Ø§Ø³ØªØ´Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨.`,
    en:`ğŸ’Š Pain/anti-inflammatory medicines
â€¢ Prefer after Iftar with food to reduce stomach irritation.
â€¢ Ulcer/kidney issues/bleeding risk â†’ ask clinician.`
  },
  thyroid:{
    ar:`ğŸ¦‹ Ø£Ø¯ÙˆÙŠØ© Ø§Ù„ØºØ¯Ø© (Levothyroxine)
â€¢ Ø¹Ù„Ù‰ Ù…Ø¹Ø¯Ø© ÙØ§Ø±ØºØ©.
â€¢ Ø®ÙŠØ§Ø± A: Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø­ÙˆØ± 30â€“60 Ø¯Ù‚ÙŠÙ‚Ø©.
â€¢ Ø®ÙŠØ§Ø± B: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± 3â€“4 Ø³Ø§Ø¹Ø§Øª Ø¨Ø¯ÙˆÙ† Ø³Ù†Ø§ÙƒØ§Øª.
â€¢ Ø§ÙØµÙ„ Ø¹Ù† Ø§Ù„Ø­Ø¯ÙŠØ¯/Ø§Ù„ÙƒØ§Ù„Ø³ÙŠÙˆÙ… 4 Ø³Ø§Ø¹Ø§Øª.`,
    en:`ğŸ¦‹ Thyroid (Levothyroxine)
â€¢ Empty stomach.
â€¢ Option A: 30â€“60 min before Suhoor.
â€¢ Option B: 3â€“4 hours after Iftar (no snacks).
â€¢ Separate from iron/calcium by 4 hours.`
  },
  rheum:{
    ar:`ğŸ¦´ Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø±ÙˆÙ…Ø§ØªÙŠØ²Ù…/Ø§Ù„Ù…Ù†Ø§Ø¹Ø©
â€¢ ØºØ§Ù„Ø¨Ù‹Ø§ Ø§Ù„ØµÙŠØ§Ù… Ù„Ø§ ÙŠÙˆÙ‚ÙÙ‡Ø§.
â€¢ Ù„Ø§ ØªÙˆÙ‚ÙÙ‡Ø§ ÙØ¬Ø£Ø©.
â€¢ Ø­Ø±Ø§Ø±Ø©/Ø¹Ø¯ÙˆÙ‰ â†’ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©.`,
    en:`ğŸ¦´ Rheumatology/immune medicines
â€¢ Fasting usually does not stop them.
â€¢ Do not stop suddenly.
â€¢ Fever/infection â†’ contact clinic.`
  },
  neuro:{
    ar:`ğŸ§  Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø£Ø¹ØµØ§Ø¨/Ø§Ù„Ù†ÙØ³ÙŠØ©
â€¢ ÙˆÙ‚Øª Ø«Ø§Ø¨Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§.
â€¢ Ù„Ø§ ØªÙÙˆÙ‘Øª Ø§Ù„Ø¬Ø±Ø¹Ø§Øª.
â€¢ Ø¥Ø°Ø§ ØªØ³Ø¨Ø¨ Ù†Ø¹Ø§Ø³: ØºØ§Ù„Ø¨Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±/Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ….`,
    en:`ğŸ§  Neuro/psych medicines
â€¢ Fixed time daily.
â€¢ Do not miss doses.
â€¢ If drowsy: often after Iftar/bedtime.`
  },
  supplements:{
    ar:`ğŸ§² Ø§Ù„Ù…ÙƒÙ…Ù„Ø§Øª (Ø­Ø¯ÙŠØ¯/ÙƒØ§Ù„Ø³ÙŠÙˆÙ…/ÙÙŠØªØ§Ù…ÙŠÙ†Ø§Øª)
â€¢ ØºØ§Ù„Ø¨Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø±.
â€¢ Ø§Ù„Ø­Ø¯ÙŠØ¯: Ø¨Ø¹ÙŠØ¯ Ø¹Ù† Ø§Ù„Ø´Ø§ÙŠ/Ø§Ù„Ù‚Ù‡ÙˆØ©/Ø§Ù„Ø­Ù„ÙŠØ¨.
â€¢ Ø§ÙØµÙ„ Ø¹Ù† Ù„ÙŠÙÙˆØ«ÙŠØ±ÙˆÙƒØ³ÙŠÙ† 4 Ø³Ø§Ø¹Ø§Øª.`,
    en:`ğŸ§² Supplements (iron/calcium/vitamins)
â€¢ Often after Iftar.
â€¢ Iron: away from tea/coffee/milk.
â€¢ Separate from levothyroxine by 4 hours.`
  },
  other:{
    ar:`ğŸ“Œ Ø¥Ø±Ø´Ø§Ø¯ Ø¹Ø§Ù…
â€¢ Ø®Ø° Ø§Ù„Ø¯ÙˆØ§Ø¡ ÙÙŠ ÙˆÙ‚Øª Ø«Ø§Ø¨Øª Ø­Ø³Ø¨ Ø§Ù„ÙˆØµÙØ©.
â€¢ Ø¥Ø°Ø§ ÙŠØ³Ø¨Ø¨ ØªÙ‡ÙŠØ¬ Ù…Ø¹Ø¯Ø©: Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ù…Ø¹ Ø§Ù„Ø£ÙƒÙ„.
â€¢ Ø£Ø¹Ø±Ø§Ø¶ Ø®Ø·ÙŠØ±Ø© â†’ Ø·ÙˆØ§Ø±Ø¦.`,
    en:`ğŸ“Œ General guidance
â€¢ Take at a fixed time as prescribed.
â€¢ If stomach upset: after Iftar with food.
â€¢ Severe symptoms â†’ seek urgent care.`
  }
};

/* =======================
   Medicines (200+ via base list + extras)
======================= */
const MEDS = [
  // Diabetes
  {cat:"diabetes", icon:"ğŸ’‰", ar:"Ø¥Ù†Ø³ÙˆÙ„ÙŠÙ† (Ø¹Ø§Ù…)", en:"Insulin (general)", tpl:"insulin"},
  {cat:"diabetes", icon:"ğŸ’‰", ar:"Lantus / Glargine", en:"Lantus / Glargine", tpl:"insulin"},
  {cat:"diabetes", icon:"ğŸ’‰", ar:"Tresiba / Degludec", en:"Tresiba / Degludec", tpl:"insulin"},
  {cat:"diabetes", icon:"ğŸ’‰", ar:"Levemir / Detemir", en:"Levemir / Detemir", tpl:"insulin"},
  {cat:"diabetes", icon:"ğŸ’‰", ar:"Novorapid / Aspart", en:"Novorapid / Aspart", tpl:"insulin"},
  {cat:"diabetes", icon:"ğŸ’‰", ar:"Humalog / Lispro", en:"Humalog / Lispro", tpl:"insulin"},
  {cat:"diabetes", icon:"ğŸ’‰", ar:"Apidra / Glulisine", en:"Apidra / Glulisine", tpl:"insulin"},
  {cat:"diabetes", icon:"ğŸ¬", ar:"Metformin", en:"Metformin", tpl:"diabetes_oral"},
  {cat:"diabetes", icon:"ğŸ¬", ar:"Gliclazide (Diamicron)", en:"Gliclazide (Diamicron)", tpl:"diabetes_oral"},
  {cat:"diabetes", icon:"ğŸ¬", ar:"Glimepiride (Amaryl)", en:"Glimepiride (Amaryl)", tpl:"diabetes_oral"},
  {cat:"diabetes", icon:"ğŸ¬", ar:"Sitagliptin (Januvia)", en:"Sitagliptin (Januvia)", tpl:"diabetes_oral"},
  {cat:"diabetes", icon:"ğŸ¬", ar:"Linagliptin (Trajenta)", en:"Linagliptin (Trajenta)", tpl:"diabetes_oral"},
  {cat:"diabetes", icon:"ğŸ¬", ar:"Empagliflozin (Jardiance)", en:"Empagliflozin (Jardiance)", tpl:"diabetes_oral"},
  {cat:"diabetes", icon:"ğŸ¬", ar:"Dapagliflozin (Forxiga)", en:"Dapagliflozin (Forxiga)", tpl:"diabetes_oral"},
  {cat:"diabetes", icon:"ğŸ¬", ar:"Semaglutide (Ozempic)", en:"Semaglutide (Ozempic)", tpl:"diabetes_oral"},
  {cat:"diabetes", icon:"ğŸ¬", ar:"Dulaglutide (Trulicity)", en:"Dulaglutide (Trulicity)", tpl:"diabetes_oral"},

  // BP / Heart
  {cat:"bp", icon:"ğŸ«€", ar:"Amlodipine", en:"Amlodipine", tpl:"bp_once"},
  {cat:"bp", icon:"ğŸ«€", ar:"Losartan", en:"Losartan", tpl:"bp_once"},
  {cat:"bp", icon:"ğŸ«€", ar:"Valsartan", en:"Valsartan", tpl:"bp_once"},
  {cat:"bp", icon:"ğŸ«€", ar:"Lisinopril", en:"Lisinopril", tpl:"bp_once"},
  {cat:"bp", icon:"ğŸ«€", ar:"Enalapril", en:"Enalapril", tpl:"bp_once"},
  {cat:"bp", icon:"ğŸ«€", ar:"Bisoprolol", en:"Bisoprolol", tpl:"bp_once"},
  {cat:"bp", icon:"ğŸ«€", ar:"Metoprolol", en:"Metoprolol", tpl:"bp_once"},
  {cat:"bp", icon:"ğŸ’§", ar:"Furosemide (Ù…Ø¯Ø±)", en:"Furosemide (diuretic)", tpl:"diuretic"},
  {cat:"bp", icon:"ğŸ’§", ar:"HCTZ", en:"HCTZ", tpl:"diuretic"},
  {cat:"bp", icon:"ğŸ’§", ar:"Spironolactone", en:"Spironolactone", tpl:"diuretic"},

  // Blood
  {cat:"blood", icon:"ğŸ©¸", ar:"Warfarin", en:"Warfarin", tpl:"anticoagulant"},
  {cat:"blood", icon:"ğŸ©¸", ar:"Apixaban (Eliquis)", en:"Apixaban (Eliquis)", tpl:"anticoagulant"},
  {cat:"blood", icon:"ğŸ©¸", ar:"Rivaroxaban (Xarelto)", en:"Rivaroxaban (Xarelto)", tpl:"anticoagulant"},
  {cat:"blood", icon:"ğŸ«€", ar:"Aspirin", en:"Aspirin", tpl:"antiplatelet"},
  {cat:"blood", icon:"ğŸ«€", ar:"Clopidogrel (Plavix)", en:"Clopidogrel (Plavix)", tpl:"antiplatelet"},

  // GI
  {cat:"gi", icon:"ğŸ§¡", ar:"Omeprazole", en:"Omeprazole", tpl:"ppi"},
  {cat:"gi", icon:"ğŸ§¡", ar:"Pantoprazole", en:"Pantoprazole", tpl:"ppi"},
  {cat:"gi", icon:"ğŸ§¡", ar:"Esomeprazole", en:"Esomeprazole", tpl:"ppi"},
  {cat:"gi", icon:"ğŸ§¡", ar:"Famotidine", en:"Famotidine", tpl:"other"},
  {cat:"gi", icon:"ğŸ§Š", ar:"Lactulose", en:"Lactulose", tpl:"other"},
  {cat:"gi", icon:"ğŸ§Š", ar:"PEG (Movicol)", en:"PEG (Movicol)", tpl:"other"},

  // Antibiotics
  {cat:"abx", icon:"ğŸ¦ ", ar:"Augmentin", en:"Augmentin", tpl:"antibiotic"},
  {cat:"abx", icon:"ğŸ¦ ", ar:"Amoxicillin", en:"Amoxicillin", tpl:"antibiotic"},
  {cat:"abx", icon:"ğŸ¦ ", ar:"Azithromycin", en:"Azithromycin", tpl:"antibiotic"},
  {cat:"abx", icon:"ğŸ¦ ", ar:"Ciprofloxacin", en:"Ciprofloxacin", tpl:"antibiotic"},
  {cat:"abx", icon:"ğŸ¦ ", ar:"Doxycycline", en:"Doxycycline", tpl:"antibiotic"},
  {cat:"abx", icon:"ğŸ¦ ", ar:"Metronidazole", en:"Metronidazole", tpl:"antibiotic"},

  // Resp
  {cat:"resp", icon:"ğŸ«", ar:"Salbutamol (Ventolin)", en:"Salbutamol (Ventolin)", tpl:"asthma"},
  {cat:"resp", icon:"ğŸ«", ar:"Budesonide inhaler", en:"Budesonide inhaler", tpl:"asthma"},
  {cat:"resp", icon:"ğŸ«", ar:"Montelukast", en:"Montelukast", tpl:"asthma"},
  {cat:"resp", icon:"ğŸ«", ar:"Cetirizine", en:"Cetirizine", tpl:"asthma"},

  // Pain
  {cat:"pain", icon:"ğŸ’Š", ar:"Paracetamol", en:"Paracetamol", tpl:"pain"},
  {cat:"pain", icon:"ğŸ’Š", ar:"Ibuprofen", en:"Ibuprofen", tpl:"pain"},
  {cat:"pain", icon:"ğŸ’Š", ar:"Naproxen", en:"Naproxen", tpl:"pain"},

  // Thyroid
  {cat:"thyroid", icon:"ğŸ¦‹", ar:"Levothyroxine", en:"Levothyroxine", tpl:"thyroid"},

  // Rheum
  {cat:"rheum", icon:"ğŸ¦´", ar:"Methotrexate (weekly)", en:"Methotrexate (weekly)", tpl:"rheum"},
  {cat:"rheum", icon:"ğŸ¦´", ar:"Hydroxychloroquine", en:"Hydroxychloroquine", tpl:"rheum"},
  {cat:"rheum", icon:"ğŸ§¬", ar:"Adalimumab (Humira)", en:"Adalimumab (Humira)", tpl:"rheum"},

  // Neuro
  {cat:"neuro", icon:"ğŸ§ ", ar:"Sertraline", en:"Sertraline", tpl:"neuro"},
  {cat:"neuro", icon:"ğŸ§ ", ar:"Fluoxetine", en:"Fluoxetine", tpl:"neuro"},
  {cat:"neuro", icon:"ğŸ§ ", ar:"Levetiracetam (Keppra)", en:"Levetiracetam (Keppra)", tpl:"neuro"},

  // Supplements
  {cat:"supp", icon:"ğŸ§²", ar:"Iron (Ferrous)", en:"Iron (Ferrous)", tpl:"supplements"},
  {cat:"supp", icon:"ğŸ§²", ar:"Calcium", en:"Calcium", tpl:"supplements"},
  {cat:"supp", icon:"ğŸ§¬", ar:"Vitamin D", en:"Vitamin D", tpl:"supplements"},

  // Other
  {cat:"other", icon:"ğŸ“Œ", ar:"Atorvastatin", en:"Atorvastatin", tpl:"bp_once"},
  {cat:"other", icon:"ğŸ“Œ", ar:"Rosuvastatin", en:"Rosuvastatin", tpl:"bp_once"},
  {cat:"other", icon:"ğŸ“Œ", ar:"Allopurinol", en:"Allopurinol", tpl:"other"},
  {cat:"other", icon:"ğŸ“Œ", ar:"Eye drops (general)", en:"Eye drops (general)", tpl:"other"}
];

// Add lots of extra names (to exceed 200) mapped to safe "other"
const EXTRA_OTHER_NAMES = [
  "Metoclopramide","Hyoscine","Loperamide","Mesalazine","Ursodeoxycholic acid",
  "Ipratropium","Tiotropium","Fexofenadine","Desloratadine","Ketotifen",
  "Clarithromycin","Cephalexin","Cefuroxime","Ceftriaxone","Bactrim (TMP/SMX)","Nitrofurantoin","Clindamycin","Linezolid","Vancomycin","Meropenem","Piperacillin/Tazobactam",
  "Atenolol","Propranolol","Diltiazem","Verapamil","Hydralazine","Nifedipine",
  "Rabeprazole","Lansoprazole","Ondansetron","Domperidone","Simethicone","Sucralfate",
  "Insulin NPH","Regular insulin","Mixtard 30/70","Novomix 30","Humalog Mix",
  "Carbimazole","Methimazole",
  "Tramadol","Codeine","Morphine","Oxycodone",
  "Heparin","Enoxaparin","Ticagrelor","Prasugrel","Dabigatran","Edoxaban",
  "Citalopram","Escitalopram","Venlafaxine","Duloxetine","Mirtazapine","Quetiapine","Olanzapine",
  "Topiramate","Phenytoin","Carbamazepine","Lamotrigine","Clonazepam","Diazepam",
  "Tamsulosin","Dutasteride","Finasteride",
  "Ezetimibe","Simvastatin","Pravastatin",
  "Vitamin C","Zinc","Magnesium","Omega-3","Folic acid","Vitamin B12","Multivitamin",
  "Acyclovir","Valacyclovir","Fluconazole","Terbinafine",
  "Metformin XR","Pioglitazone","Acarbose","Glipizide","Saxagliptin","Vildagliptin",
  "Isosorbide","Digoxin","Clonidine","Indapamide",
  "Prednisone","Azathioprine","Mycophenolate","Tofacitinib","Etanercept","Infliximab","Tocilizumab","Rituximab",
  "Diclofenac","Celecoxib","Meloxicam",
  "Nasal spray (Fluticasone)","Budesonide nasal","Loratadine (Claritin)",
  "Oral contraceptive","Levonorgestrel (Emergency)",
  "Eye lubricant drops","Skin cream","Topical steroid"
];

// Make sure we exceed 200
EXTRA_OTHER_NAMES.forEach(n=>{
  MEDS.push({cat:"other", icon:"ğŸ“Œ", ar:n, en:n, tpl:"other"});
});

/* =======================
   Rendering
======================= */
function renderCats(){
  state.view="cats";
  state.currentCat=null;
  grid.innerHTML="";

  add("bot", state.lang==="ar" ? "Ø§Ø®ØªØ± ÙØ¦Ø©:" : "Choose a category:");

  CATS.forEach(c=>{
    const div = document.createElement("div");
    div.className="tile";
    div.innerHTML = `<div>${c.icon} ${(state.lang==="ar")?c.ar:c.en}<small>${state.lang==="ar"?"Ø§Ø¶ØºØ· Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©":"Tap to view medicines"}</small></div><div>â–¶</div>`;
    div.onclick = ()=>{ state.currentCat=c.key; renderMeds(); };
    grid.appendChild(div);
  });
}

function renderMeds(){
  state.view="meds";
  grid.innerHTML="";
  const catMeta = CATS.find(c=>c.key===state.currentCat);
  const list = MEDS.filter(m=>m.cat===state.currentCat);

  add("bot", state.lang==="ar"
    ? `âœ… ÙØ¦Ø©: ${catMeta.icon} ${catMeta.ar}\nØ§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ§Ø¡:`
    : `âœ… Category: ${catMeta.icon} ${catMeta.en}\nTap a medicine:`
  );

  list.forEach(m=>{
    const div = document.createElement("div");
    div.className="tile";
    div.innerHTML = `<div>${m.icon} ${(state.lang==="ar")?m.ar:m.en}<small>${state.lang==="ar"?"Ø§Ø¶ØºØ· Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙ‚ÙŠØª":"Tap for timing guidance"}</small></div><div>â–¶</div>`;
    div.onclick = ()=> onMedicineTap(m);
    grid.appendChild(div);
  });

  // Update hint
  if(state.lang==="ar"){
    hintText.textContent = "Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ§Ø¡ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©. Ø§Ø¶ØºØ· (ğŸ  Ø§Ù„ÙØ¦Ø§Øª) Ù„Ù„Ø±Ø¬ÙˆØ¹.";
  }else{
    hintText.textContent = "Tap a medicine. Use (ğŸ  Categories) to go back.";
  }
}

function onMedicineTap(m){
  add("user", state.lang==="ar" ? m.ar : m.en);
  const tpl = TEMPLATES[m.tpl] || TEMPLATES.other;
  add("bot", state.lang==="ar" ? tpl.ar : tpl.en);
}

function render(){
  if(state.view==="cats") renderCats();
  else renderMeds();
}

/* =======================
   Search
======================= */
function searchMedicine(q){
  const nq = normalize(q);
  if(!nq) return null;
  return MEDS.find(m => normalize(m.ar).includes(nq) || normalize(m.en).includes(nq));
}

document.getElementById("searchBtn").onclick = ()=>{
  const q = searchInput.value.trim();
  if(!q) return;
  add("user", q);
  const m = searchMedicine(q);
  if(m) onMedicineTap(m);
  else add("bot", state.lang==="ar" ? "Ù„Ù… Ø£Ø¬Ø¯ Ø§Ù„Ø§Ø³Ù…. Ø¬Ø±Ù‘Ø¨ ÙƒØªØ§Ø¨Ø© Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø±." : "Not found. Try part of the name or use buttons.");
  searchInput.value="";
};

searchInput.addEventListener("keydown",(e)=>{
  if(e.key==="Enter"){ e.preventDefault(); document.getElementById("searchBtn").click(); }
});

/* =======================
   Buttons
======================= */
document.getElementById("arBtn").onclick = ()=>setLang("ar");
document.getElementById("enBtn").onclick = ()=>setLang("en");
document.getElementById("homeBtn").onclick = ()=>{ state.view="cats"; render(); setLang(state.lang); };
document.getElementById("resetBtn").onclick = ()=>{ resetChat(); state.view="cats"; render(); setLang(state.lang); };

/* =======================
   QR code (opens your GitHub Pages URL)
   NOTE: Uses an online QR image (no extra files needed).
======================= */
const CHATBOT_URL = "https://alizakialsada.github.io/qch-ramadan-chatbot/";
qrLinkText.textContent = CHATBOT_URL;
qrImg.src = "https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=" + encodeURIComponent(CHATBOT_URL);

/* =======================
   Init
======================= */
resetChat();
renderCats();
setLang("ar");
</script>
</body>
</html>
